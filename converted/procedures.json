[
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_ACCOUNT_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_account_stg\n(CDC_FLAG string COMMENT 'I OR U DENOTES INSERT OR UPDATE',\n CDC_DSN INT COMMENT 'DATABASE SEQUENCE NUMBER',\n CA_ID INT NOT NULL COMMENT 'CUSTOMER ACCOUNT IDENTIFIER',\n CA_B_ID INT NOT NULL COMMENT 'IDENTIFIER OF THE MANAGING BROKER',\n CA_C_ID INT NOT NULL COMMENT 'OWNING CUSTOMER IDENTIFIER',\n CA_NAME string COMMENT 'NAME OF CUSTOMER ACCOUNT', CA_TAX_ST INT COMMENT '0,\n 1 OR 2 TAX STATUS OF THIS ACCOUNT',\n CA_ST_ID string COMMENT 'ACTV OR INAC CUSTOMER STATUS TYPE IDENTIFIER')\nusing delta \nas select\n _c0::string CDC_FLAG, _c1::INT CDC_DSN, _c2::INT CA_ID, _c3::INT CA_B_ID,\n _c4::INT CA_C_ID, _c5::string CA_NAME, _c6::INT CA_TAX_ST,\n _c7::string CA_ST_ID\nfrom cloud_files(\n                 \"s3://tpcdi-files/tmp/tpcdi/sf=${tpcdi_scale}/Batch${batch_counter}/Account\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_account_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX2FjY291bnRfc3RnCihDRENfRkxBRyBzdHJpbmcgQ09NTUVOVCAnSSBPUiBVIERFTk9URVMgSU5TRVJUIE9SIFVQREFURScsCiBDRENfRFNOIElOVCBDT01NRU5UICdEQVRBQkFTRSBTRVFVRU5DRSBOVU1CRVInLAogQ0FfSUQgSU5UIE5PVCBOVUxMIENPTU1FTlQgJ0NVU1RPTUVSIEFDQ09VTlQgSURFTlRJRklFUicsCiBDQV9CX0lEIElOVCBOT1QgTlVMTCBDT01NRU5UICdJREVOVElGSUVSIE9GIFRIRSBNQU5BR0lORyBCUk9LRVInLAogQ0FfQ19JRCBJTlQgTk9UIE5VTEwgQ09NTUVOVCAnT1dOSU5HIENVU1RPTUVSIElERU5USUZJRVInLAogQ0FfTkFNRSBzdHJpbmcgQ09NTUVOVCAnTkFNRSBPRiBDVVNUT01FUiBBQ0NPVU5UJywgQ0FfVEFYX1NUIElOVCBDT01NRU5UICcwLAogMSBPUiAyIFRBWCBTVEFUVVMgT0YgVEhJUyBBQ0NPVU5UJywKIENBX1NUX0lEIHN0cmluZyBDT01NRU5UICdBQ1RWIE9SIElOQUMgQ1VTVE9NRVIgU1RBVFVTIFRZUEUgSURFTlRJRklFUicpCnVzaW5nIGRlbHRhIAphcyBzZWxlY3QKIF9jMDo6c3RyaW5nIENEQ19GTEFHLCBfYzE6OklOVCBDRENfRFNOLCBfYzI6OklOVCBDQV9JRCwgX2MzOjpJTlQgQ0FfQl9JRCwKIF9jNDo6SU5UIENBX0NfSUQsIF9jNTo6c3RyaW5nIENBX05BTUUsIF9jNjo6SU5UIENBX1RBWF9TVCwKIF9jNzo6c3RyaW5nIENBX1NUX0lECmZyb20gY2xvdWRfZmlsZXMoCiAgICAgICAgICAgICAgICAgInMzOi8vdHBjZGktZmlsZXMvdG1wL3RwY2RpL3NmPSR7dHBjZGlfc2NhbGV9L0JhdGNoJHtiYXRjaF9jb3VudGVyfS9BY2NvdW50IiwKICAgICAgICAgICAgICAgICAiY3N2IiwKICAgICAgICAgICAgICAgICBtYXAoImluZmVyU2NoZW1hIiwgIkZhbHNlIiwgCiAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAiaGVhZGVyIiwgIkZhbHNlIiwKICAgICAgICAgICAgICAgICAgICAgImRlbGltaXRlciIsICJ8IikKICAgICAgICAgICAgICAgICk=",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_CASHTRANSACTION_H_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_cashtransaction_stg\n(CDC_FLAG string COMMENT 'I DENOTES INSERT',\n CDC_DSN INT COMMENT 'DATABASE SEQUENCE NUMBER',\n CT_CA_ID INT NOT NULL COMMENT 'CUSTOMER ACCOUNT IDENTIFIER',\n CT_DTS TIMESTAMP NOT NULL COMMENT 'TIMESTAMP OF WHEN THE TRADE TOOK PLACE',\n CT_AMT DECIMAL ( 10 , 2 ) NOT NULL COMMENT 'AMOUNT OF THE CASH TRANSACTION',\n CT_NAME string NOT NULL COMMENT 'TRANSACTION NAME OR DESCRIPTION: E.G. \"CASH FROM SALE OF DUPONT STOCK\".')\nusing delta \nas select\n _c0::string CT_CA_ID, _c1::INT CT_DTS, _c2::INT CT_AMT, _c3::TIMESTAMP CT_NAME\nfrom cloud_files(\n                 \"s3://tpcdi-files/tmp/tpcdi/sf=${tpcdi_scale}/Batch1/CashTransaction\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_cashtransaction_h_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX2Nhc2h0cmFuc2FjdGlvbl9zdGcKKENEQ19GTEFHIHN0cmluZyBDT01NRU5UICdJIERFTk9URVMgSU5TRVJUJywKIENEQ19EU04gSU5UIENPTU1FTlQgJ0RBVEFCQVNFIFNFUVVFTkNFIE5VTUJFUicsCiBDVF9DQV9JRCBJTlQgTk9UIE5VTEwgQ09NTUVOVCAnQ1VTVE9NRVIgQUNDT1VOVCBJREVOVElGSUVSJywKIENUX0RUUyBUSU1FU1RBTVAgTk9UIE5VTEwgQ09NTUVOVCAnVElNRVNUQU1QIE9GIFdIRU4gVEhFIFRSQURFIFRPT0sgUExBQ0UnLAogQ1RfQU1UIERFQ0lNQUwgKCAxMCAsIDIgKSBOT1QgTlVMTCBDT01NRU5UICdBTU9VTlQgT0YgVEhFIENBU0ggVFJBTlNBQ1RJT04nLAogQ1RfTkFNRSBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnVFJBTlNBQ1RJT04gTkFNRSBPUiBERVNDUklQVElPTjogRS5HLiAiQ0FTSCBGUk9NIFNBTEUgT0YgRFVQT05UIFNUT0NLIi4nKQp1c2luZyBkZWx0YSAKYXMgc2VsZWN0CiBfYzA6OnN0cmluZyBDVF9DQV9JRCwgX2MxOjpJTlQgQ1RfRFRTLCBfYzI6OklOVCBDVF9BTVQsIF9jMzo6VElNRVNUQU1QIENUX05BTUUKZnJvbSBjbG91ZF9maWxlcygKICAgICAgICAgICAgICAgICAiczM6Ly90cGNkaS1maWxlcy90bXAvdHBjZGkvc2Y9JHt0cGNkaV9zY2FsZX0vQmF0Y2gxL0Nhc2hUcmFuc2FjdGlvbiIsCiAgICAgICAgICAgICAgICAgImNzdiIsCiAgICAgICAgICAgICAgICAgbWFwKCJpbmZlclNjaGVtYSIsICJGYWxzZSIsIAogICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgImhlYWRlciIsICJGYWxzZSIsCiAgICAgICAgICAgICAgICAgICAgICJkZWxpbWl0ZXIiLCAifCIpCiAgICAgICAgICAgICAgICAp",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_CASHTRANSACTION_I_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_cashtransaction_stg\n(CDC_FLAG string COMMENT 'I DENOTES INSERT',\n CDC_DSN INT COMMENT 'DATABASE SEQUENCE NUMBER',\n CT_CA_ID INT NOT NULL COMMENT 'CUSTOMER ACCOUNT IDENTIFIER',\n CT_DTS TIMESTAMP NOT NULL COMMENT 'TIMESTAMP OF WHEN THE TRADE TOOK PLACE',\n CT_AMT DECIMAL ( 10 , 2 ) NOT NULL COMMENT 'AMOUNT OF THE CASH TRANSACTION',\n CT_NAME string NOT NULL COMMENT 'TRANSACTION NAME OR DESCRIPTION: E.G. \"CASH FROM SALE OF DUPONT STOCK\".')\nusing delta \nas select\n _c0::string CDC_FLAG, _c1::INT CDC_DSN, _c2::INT CT_CA_ID,\n _c3::TIMESTAMP CT_DTS, _c4::DECIMAL(10, 2) CT_AMT, _c5::string CT_NAME\nfrom cloud_files(\n                 \"s3://tpcdi-files/tmp/tpcdi/sf=${tpcdi_scale}/Batch${batch_counter}/CashTransaction\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_cashtransaction_i_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX2Nhc2h0cmFuc2FjdGlvbl9zdGcKKENEQ19GTEFHIHN0cmluZyBDT01NRU5UICdJIERFTk9URVMgSU5TRVJUJywKIENEQ19EU04gSU5UIENPTU1FTlQgJ0RBVEFCQVNFIFNFUVVFTkNFIE5VTUJFUicsCiBDVF9DQV9JRCBJTlQgTk9UIE5VTEwgQ09NTUVOVCAnQ1VTVE9NRVIgQUNDT1VOVCBJREVOVElGSUVSJywKIENUX0RUUyBUSU1FU1RBTVAgTk9UIE5VTEwgQ09NTUVOVCAnVElNRVNUQU1QIE9GIFdIRU4gVEhFIFRSQURFIFRPT0sgUExBQ0UnLAogQ1RfQU1UIERFQ0lNQUwgKCAxMCAsIDIgKSBOT1QgTlVMTCBDT01NRU5UICdBTU9VTlQgT0YgVEhFIENBU0ggVFJBTlNBQ1RJT04nLAogQ1RfTkFNRSBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnVFJBTlNBQ1RJT04gTkFNRSBPUiBERVNDUklQVElPTjogRS5HLiAiQ0FTSCBGUk9NIFNBTEUgT0YgRFVQT05UIFNUT0NLIi4nKQp1c2luZyBkZWx0YSAKYXMgc2VsZWN0CiBfYzA6OnN0cmluZyBDRENfRkxBRywgX2MxOjpJTlQgQ0RDX0RTTiwgX2MyOjpJTlQgQ1RfQ0FfSUQsCiBfYzM6OlRJTUVTVEFNUCBDVF9EVFMsIF9jNDo6REVDSU1BTCgxMCwgMikgQ1RfQU1ULCBfYzU6OnN0cmluZyBDVF9OQU1FCmZyb20gY2xvdWRfZmlsZXMoCiAgICAgICAgICAgICAgICAgInMzOi8vdHBjZGktZmlsZXMvdG1wL3RwY2RpL3NmPSR7dHBjZGlfc2NhbGV9L0JhdGNoJHtiYXRjaF9jb3VudGVyfS9DYXNoVHJhbnNhY3Rpb24iLAogICAgICAgICAgICAgICAgICJjc3YiLAogICAgICAgICAgICAgICAgIG1hcCgiaW5mZXJTY2hlbWEiLCAiRmFsc2UiLCAKICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICJoZWFkZXIiLCAiRmFsc2UiLAogICAgICAgICAgICAgICAgICAgICAiZGVsaW1pdGVyIiwgInwiKQogICAgICAgICAgICAgICAgKQ==",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_CASHTRANSACTION_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_cashtransaction_stg\n(CDC_FLAG string COMMENT 'I DENOTES INSERT',\n CDC_DSN INT COMMENT 'DATABASE SEQUENCE NUMBER',\n CT_CA_ID INT NOT NULL COMMENT 'CUSTOMER ACCOUNT IDENTIFIER',\n CT_DTS TIMESTAMP NOT NULL COMMENT 'TIMESTAMP OF WHEN THE TRADE TOOK PLACE',\n CT_AMT DECIMAL ( 10 , 2 ) NOT NULL COMMENT 'AMOUNT OF THE CASH TRANSACTION',\n CT_NAME string NOT NULL COMMENT 'TRANSACTION NAME OR DESCRIPTION: E.G. \"CASH FROM SALE OF DUPONT STOCK\".')\nusing delta \nas select\n _c0::string CDC_FLAG, _c1::INT CDC_DSN, _c2::INT CT_CA_ID,\n _c3::TIMESTAMP CT_DTS, _c4::DECIMAL(10, 2) CT_AMT, _c5::string CT_NAME\nfrom cloud_files(\n                 \"s3://tpcdi-files/load/cash_transaction/\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_cashtransaction_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX2Nhc2h0cmFuc2FjdGlvbl9zdGcKKENEQ19GTEFHIHN0cmluZyBDT01NRU5UICdJIERFTk9URVMgSU5TRVJUJywKIENEQ19EU04gSU5UIENPTU1FTlQgJ0RBVEFCQVNFIFNFUVVFTkNFIE5VTUJFUicsCiBDVF9DQV9JRCBJTlQgTk9UIE5VTEwgQ09NTUVOVCAnQ1VTVE9NRVIgQUNDT1VOVCBJREVOVElGSUVSJywKIENUX0RUUyBUSU1FU1RBTVAgTk9UIE5VTEwgQ09NTUVOVCAnVElNRVNUQU1QIE9GIFdIRU4gVEhFIFRSQURFIFRPT0sgUExBQ0UnLAogQ1RfQU1UIERFQ0lNQUwgKCAxMCAsIDIgKSBOT1QgTlVMTCBDT01NRU5UICdBTU9VTlQgT0YgVEhFIENBU0ggVFJBTlNBQ1RJT04nLAogQ1RfTkFNRSBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnVFJBTlNBQ1RJT04gTkFNRSBPUiBERVNDUklQVElPTjogRS5HLiAiQ0FTSCBGUk9NIFNBTEUgT0YgRFVQT05UIFNUT0NLIi4nKQp1c2luZyBkZWx0YSAKYXMgc2VsZWN0CiBfYzA6OnN0cmluZyBDRENfRkxBRywgX2MxOjpJTlQgQ0RDX0RTTiwgX2MyOjpJTlQgQ1RfQ0FfSUQsCiBfYzM6OlRJTUVTVEFNUCBDVF9EVFMsIF9jNDo6REVDSU1BTCgxMCwgMikgQ1RfQU1ULCBfYzU6OnN0cmluZyBDVF9OQU1FCmZyb20gY2xvdWRfZmlsZXMoCiAgICAgICAgICAgICAgICAgInMzOi8vdHBjZGktZmlsZXMvbG9hZC9jYXNoX3RyYW5zYWN0aW9uLyIsCiAgICAgICAgICAgICAgICAgImNzdiIsCiAgICAgICAgICAgICAgICAgbWFwKCJpbmZlclNjaGVtYSIsICJGYWxzZSIsIAogICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgImhlYWRlciIsICJGYWxzZSIsCiAgICAgICAgICAgICAgICAgICAgICJkZWxpbWl0ZXIiLCAifCIpCiAgICAgICAgICAgICAgICAp",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_CUSTOMER_MGMT_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_customer_mgmt_stg\n(XML VARIANT_0000 COMMENT 'XML STRING')\nusing delta \nas select\n _c0::VARIANT_0000 XML\nfrom cloud_files(\n                 \"s3://tpcdi-files/tmp/tpcdi/sf=${tpcdi_scale}/Batch1/CustomerMgmt\",\n                 \"xml\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \",\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_customer_mgmt_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX2N1c3RvbWVyX21nbXRfc3RnCihYTUwgVkFSSUFOVF8wMDAwIENPTU1FTlQgJ1hNTCBTVFJJTkcnKQp1c2luZyBkZWx0YSAKYXMgc2VsZWN0CiBfYzA6OlZBUklBTlRfMDAwMCBYTUwKZnJvbSBjbG91ZF9maWxlcygKICAgICAgICAgICAgICAgICAiczM6Ly90cGNkaS1maWxlcy90bXAvdHBjZGkvc2Y9JHt0cGNkaV9zY2FsZX0vQmF0Y2gxL0N1c3RvbWVyTWdtdCIsCiAgICAgICAgICAgICAgICAgInhtbCIsCiAgICAgICAgICAgICAgICAgbWFwKCJpbmZlclNjaGVtYSIsICJGYWxzZSIsIAogICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgImhlYWRlciIsICJGYWxzZSIsCiAgICAgICAgICAgICAgICAgICAgICJkZWxpbWl0ZXIiLCAiLCIpCiAgICAgICAgICAgICAgICAp",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_CUSTOMER_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_customer_stg\n(CDC_FLAG string COMMENT 'DENOTES INSERT OR UPDATE',\n CDC_DSN INT COMMENT 'DATABASE SEQUENCE NUMBER',\n C_ID INT NOT NULL COMMENT 'CUSTOMER IDENTIFIER',\n C_TAX_ID string NOT NULL COMMENT 'CUSTOMER\u2019S TAX IDENTIFIER',\n C_ST_ID string COMMENT 'ACTV OR INAC CUSTOMER STATUS TYPE IDENTIFIER',\n C_L_NAME string NOT NULL COMMENT 'PRIMARY CUSTOMER''S LAST NAME.',\n C_F_NAME string NOT NULL COMMENT 'PRIMARY CUSTOMER''S FIRST NAME.',\n C_M_NAME string COMMENT 'PRIMARY CUSTOMER''S MIDDLE INITIAL',\n C_GNDR string COMMENT 'GENDER OF THE PRIMARY CUSTOMER',\n C_TIER DECIMAL ( 1 ) COMMENT 'CUSTOMER TIER',\n C_DOB DATE NOT NULL COMMENT 'CUSTOMER\u2019S DATE OF BIRTH, AS YYYY-MM-DD.',\n C_ADLINE1 string NOT NULL COMMENT 'ADDRESS LINE 1',\n C_ADLINE2 string COMMENT 'ADDRESS LINE 2',\n C_ZIPCODE string NOT NULL COMMENT 'ZIP OR POSTAL CODE',\n C_CITY string NOT NULL COMMENT 'CITY',\n C_STATE_PROV string NOT NULL COMMENT 'STATE OR PROVINCE',\n C_CTRY string COMMENT 'COUNTRY',\n C_CTRY_1 string COMMENT 'COUNTRY CODE FOR CUSTOMER''S PHONE 1.',\n C_AREA_1 string COMMENT 'AREA CODE FOR CUSTOMER''S PHONE 1.',\n C_LOCAL_1 string COMMENT 'LOCAL NUMBER FOR CUSTOMER''S PHONE 1.',\n C_EXT_1 string COMMENT 'EXTENSION NUMBER FOR CUSTOMER''S PHONE 1.',\n C_CTRY_2 string COMMENT 'COUNTRY CODE FOR CUSTOMER''S PHONE 2.',\n C_AREA_2 string COMMENT 'AREA CODE FOR CUSTOMER''S PHONE 2.',\n C_LOCAL_2 string COMMENT 'LOCAL NUMBER FOR CUSTOMER''S PHONE 2.',\n C_EXT_2 string COMMENT 'EXTENSION NUMBER FOR CUSTOMER''S PHONE 2.',\n C_CTRY_3 string COMMENT 'COUNTRY CODE FOR CUSTOMER''S PHONE 3.',\n C_AREA_3 string COMMENT 'AREA CODE FOR CUSTOMER''S PHONE 3.',\n C_LOCAL_3 string COMMENT 'LOCAL NUMBER FOR CUSTOMER''S PHONE 3.',\n C_EXT_3 string COMMENT 'EXTENSION NUMBER FOR CUSTOMER''S PHONE 3.',\n C_EMAIL_1 string COMMENT 'CUSTOMER''S E-MAIL ADDRESS 1.',\n C_EMAIL_2 string COMMENT 'CUSTOMER''S E-MAIL ADDRESS 2.',\n C_LCL_TX_ID string NOT NULL COMMENT 'CUSTOMER''S LOCAL TAX RATE',\n C_NAT_TX_ID string NOT NULL COMMENT 'CUSTOMER''S NATIONAL TAX RATE')\nusing delta \nas select\n _c0::string CDC_FLAG, _c1::INT CDC_DSN, _c2::INT C_ID, _c3::string C_TAX_ID,\n _c4::string C_ST_ID, _c5::string C_L_NAME, _c6::string C_F_NAME,\n _c7::string C_M_NAME, _c8::string C_GNDR, _c9::DECIMAL(1) C_TIER,\n _c10::DATE C_DOB, _c11::string C_ADLINE1, _c12::string C_ADLINE2,\n _c13::string C_ZIPCODE, _c14::string C_CITY, _c15::string C_STATE_PROV,\n _c16::string C_CTRY, _c17::string C_CTRY_1, _c18::string C_AREA_1,\n _c19::string C_LOCAL_1, _c20::string C_EXT_1, _c21::string C_CTRY_2,\n _c22::string C_AREA_2, _c23::string C_LOCAL_2, _c24::string C_EXT_2,\n _c25::string C_CTRY_3, _c26::string C_AREA_3, _c27::string C_LOCAL_3,\n _c28::string C_EXT_3, _c29::string C_EMAIL_1, _c30::string C_EMAIL_2,\n _c31::string C_LCL_TX_ID, _c32::string C_NAT_TX_ID\nfrom cloud_files(\n                 \"s3://tpcdi-files/tmp/tpcdi/sf=${tpcdi_scale}/Batch${batch_counter}/Customer\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_customer_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX2N1c3RvbWVyX3N0ZwooQ0RDX0ZMQUcgc3RyaW5nIENPTU1FTlQgJ0RFTk9URVMgSU5TRVJUIE9SIFVQREFURScsCiBDRENfRFNOIElOVCBDT01NRU5UICdEQVRBQkFTRSBTRVFVRU5DRSBOVU1CRVInLAogQ19JRCBJTlQgTk9UIE5VTEwgQ09NTUVOVCAnQ1VTVE9NRVIgSURFTlRJRklFUicsCiBDX1RBWF9JRCBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnQ1VTVE9NRVLigJlTIFRBWCBJREVOVElGSUVSJywKIENfU1RfSUQgc3RyaW5nIENPTU1FTlQgJ0FDVFYgT1IgSU5BQyBDVVNUT01FUiBTVEFUVVMgVFlQRSBJREVOVElGSUVSJywKIENfTF9OQU1FIHN0cmluZyBOT1QgTlVMTCBDT01NRU5UICdQUklNQVJZIENVU1RPTUVSJydTIExBU1QgTkFNRS4nLAogQ19GX05BTUUgc3RyaW5nIE5PVCBOVUxMIENPTU1FTlQgJ1BSSU1BUlkgQ1VTVE9NRVInJ1MgRklSU1QgTkFNRS4nLAogQ19NX05BTUUgc3RyaW5nIENPTU1FTlQgJ1BSSU1BUlkgQ1VTVE9NRVInJ1MgTUlERExFIElOSVRJQUwnLAogQ19HTkRSIHN0cmluZyBDT01NRU5UICdHRU5ERVIgT0YgVEhFIFBSSU1BUlkgQ1VTVE9NRVInLAogQ19USUVSIERFQ0lNQUwgKCAxICkgQ09NTUVOVCAnQ1VTVE9NRVIgVElFUicsCiBDX0RPQiBEQVRFIE5PVCBOVUxMIENPTU1FTlQgJ0NVU1RPTUVS4oCZUyBEQVRFIE9GIEJJUlRILCBBUyBZWVlZLU1NLURELicsCiBDX0FETElORTEgc3RyaW5nIE5PVCBOVUxMIENPTU1FTlQgJ0FERFJFU1MgTElORSAxJywKIENfQURMSU5FMiBzdHJpbmcgQ09NTUVOVCAnQUREUkVTUyBMSU5FIDInLAogQ19aSVBDT0RFIHN0cmluZyBOT1QgTlVMTCBDT01NRU5UICdaSVAgT1IgUE9TVEFMIENPREUnLAogQ19DSVRZIHN0cmluZyBOT1QgTlVMTCBDT01NRU5UICdDSVRZJywKIENfU1RBVEVfUFJPViBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnU1RBVEUgT1IgUFJPVklOQ0UnLAogQ19DVFJZIHN0cmluZyBDT01NRU5UICdDT1VOVFJZJywKIENfQ1RSWV8xIHN0cmluZyBDT01NRU5UICdDT1VOVFJZIENPREUgRk9SIENVU1RPTUVSJydTIFBIT05FIDEuJywKIENfQVJFQV8xIHN0cmluZyBDT01NRU5UICdBUkVBIENPREUgRk9SIENVU1RPTUVSJydTIFBIT05FIDEuJywKIENfTE9DQUxfMSBzdHJpbmcgQ09NTUVOVCAnTE9DQUwgTlVNQkVSIEZPUiBDVVNUT01FUicnUyBQSE9ORSAxLicsCiBDX0VYVF8xIHN0cmluZyBDT01NRU5UICdFWFRFTlNJT04gTlVNQkVSIEZPUiBDVVNUT01FUicnUyBQSE9ORSAxLicsCiBDX0NUUllfMiBzdHJpbmcgQ09NTUVOVCAnQ09VTlRSWSBDT0RFIEZPUiBDVVNUT01FUicnUyBQSE9ORSAyLicsCiBDX0FSRUFfMiBzdHJpbmcgQ09NTUVOVCAnQVJFQSBDT0RFIEZPUiBDVVNUT01FUicnUyBQSE9ORSAyLicsCiBDX0xPQ0FMXzIgc3RyaW5nIENPTU1FTlQgJ0xPQ0FMIE5VTUJFUiBGT1IgQ1VTVE9NRVInJ1MgUEhPTkUgMi4nLAogQ19FWFRfMiBzdHJpbmcgQ09NTUVOVCAnRVhURU5TSU9OIE5VTUJFUiBGT1IgQ1VTVE9NRVInJ1MgUEhPTkUgMi4nLAogQ19DVFJZXzMgc3RyaW5nIENPTU1FTlQgJ0NPVU5UUlkgQ09ERSBGT1IgQ1VTVE9NRVInJ1MgUEhPTkUgMy4nLAogQ19BUkVBXzMgc3RyaW5nIENPTU1FTlQgJ0FSRUEgQ09ERSBGT1IgQ1VTVE9NRVInJ1MgUEhPTkUgMy4nLAogQ19MT0NBTF8zIHN0cmluZyBDT01NRU5UICdMT0NBTCBOVU1CRVIgRk9SIENVU1RPTUVSJydTIFBIT05FIDMuJywKIENfRVhUXzMgc3RyaW5nIENPTU1FTlQgJ0VYVEVOU0lPTiBOVU1CRVIgRk9SIENVU1RPTUVSJydTIFBIT05FIDMuJywKIENfRU1BSUxfMSBzdHJpbmcgQ09NTUVOVCAnQ1VTVE9NRVInJ1MgRS1NQUlMIEFERFJFU1MgMS4nLAogQ19FTUFJTF8yIHN0cmluZyBDT01NRU5UICdDVVNUT01FUicnUyBFLU1BSUwgQUREUkVTUyAyLicsCiBDX0xDTF9UWF9JRCBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnQ1VTVE9NRVInJ1MgTE9DQUwgVEFYIFJBVEUnLAogQ19OQVRfVFhfSUQgc3RyaW5nIE5PVCBOVUxMIENPTU1FTlQgJ0NVU1RPTUVSJydTIE5BVElPTkFMIFRBWCBSQVRFJykKdXNpbmcgZGVsdGEgCmFzIHNlbGVjdAogX2MwOjpzdHJpbmcgQ0RDX0ZMQUcsIF9jMTo6SU5UIENEQ19EU04sIF9jMjo6SU5UIENfSUQsIF9jMzo6c3RyaW5nIENfVEFYX0lELAogX2M0OjpzdHJpbmcgQ19TVF9JRCwgX2M1OjpzdHJpbmcgQ19MX05BTUUsIF9jNjo6c3RyaW5nIENfRl9OQU1FLAogX2M3OjpzdHJpbmcgQ19NX05BTUUsIF9jODo6c3RyaW5nIENfR05EUiwgX2M5OjpERUNJTUFMKDEpIENfVElFUiwKIF9jMTA6OkRBVEUgQ19ET0IsIF9jMTE6OnN0cmluZyBDX0FETElORTEsIF9jMTI6OnN0cmluZyBDX0FETElORTIsCiBfYzEzOjpzdHJpbmcgQ19aSVBDT0RFLCBfYzE0OjpzdHJpbmcgQ19DSVRZLCBfYzE1OjpzdHJpbmcgQ19TVEFURV9QUk9WLAogX2MxNjo6c3RyaW5nIENfQ1RSWSwgX2MxNzo6c3RyaW5nIENfQ1RSWV8xLCBfYzE4OjpzdHJpbmcgQ19BUkVBXzEsCiBfYzE5OjpzdHJpbmcgQ19MT0NBTF8xLCBfYzIwOjpzdHJpbmcgQ19FWFRfMSwgX2MyMTo6c3RyaW5nIENfQ1RSWV8yLAogX2MyMjo6c3RyaW5nIENfQVJFQV8yLCBfYzIzOjpzdHJpbmcgQ19MT0NBTF8yLCBfYzI0OjpzdHJpbmcgQ19FWFRfMiwKIF9jMjU6OnN0cmluZyBDX0NUUllfMywgX2MyNjo6c3RyaW5nIENfQVJFQV8zLCBfYzI3OjpzdHJpbmcgQ19MT0NBTF8zLAogX2MyODo6c3RyaW5nIENfRVhUXzMsIF9jMjk6OnN0cmluZyBDX0VNQUlMXzEsIF9jMzA6OnN0cmluZyBDX0VNQUlMXzIsCiBfYzMxOjpzdHJpbmcgQ19MQ0xfVFhfSUQsIF9jMzI6OnN0cmluZyBDX05BVF9UWF9JRApmcm9tIGNsb3VkX2ZpbGVzKAogICAgICAgICAgICAgICAgICJzMzovL3RwY2RpLWZpbGVzL3RtcC90cGNkaS9zZj0ke3RwY2RpX3NjYWxlfS9CYXRjaCR7YmF0Y2hfY291bnRlcn0vQ3VzdG9tZXIiLAogICAgICAgICAgICAgICAgICJjc3YiLAogICAgICAgICAgICAgICAgIG1hcCgiaW5mZXJTY2hlbWEiLCAiRmFsc2UiLCAKICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICJoZWFkZXIiLCAiRmFsc2UiLAogICAgICAgICAgICAgICAgICAgICAiZGVsaW1pdGVyIiwgInwiKQogICAgICAgICAgICAgICAgKQ==",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_DAILYMARKET_H_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_dailymarket_stg\n(CDC_FLAG string COMMENT 'I DENOTES INSERT',\n CDC_DSN INT COMMENT 'DATABASE SEQUENCE NUMBER',\n DM_DATE DATE NOT NULL COMMENT 'DATE OF LAST COMPLETED TRADING DAY.',\n DM_S_SYMB string NOT NULL COMMENT 'SECURITY SYMBOL OF THE SECURITY',\n DM_CLOSE DECIMAL ( 8 ,\n 2 ) NOT NULL COMMENT 'CLOSING PRICE OF THE SECURITY ON THIS DAY.',\n DM_HIGH DECIMAL ( 8 ,\n 2 ) NOT NULL COMMENT 'HIGHEST PRICE FOR THE SECUIRITY ON THIS DAY.',\n DM_LOW DECIMAL ( 8 ,\n 2 ) NOT NULL COMMENT 'LOWEST PRICE FOR THE SECURITY ON THIS DAY.',\n DM_VOL INT NOT NULL COMMENT 'VOLUME OF THE SECURITY ON THIS DAY.')\nusing delta \nas select\n _c0::string DM_DATE, _c1::INT DM_S_SYMB, _c2::DATE DM_CLOSE,\n _c3::string DM_HIGH, _c4::DECIMAL(8, 2) DM_LOW, _c5::DECIMAL(8, 2) DM_VOL\nfrom cloud_files(\n                 \"s3://tpcdi-files/tmp/tpcdi/sf=${tpcdi_scale}/Batch1/DailyMarket\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_dailymarket_h_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX2RhaWx5bWFya2V0X3N0ZwooQ0RDX0ZMQUcgc3RyaW5nIENPTU1FTlQgJ0kgREVOT1RFUyBJTlNFUlQnLAogQ0RDX0RTTiBJTlQgQ09NTUVOVCAnREFUQUJBU0UgU0VRVUVOQ0UgTlVNQkVSJywKIERNX0RBVEUgREFURSBOT1QgTlVMTCBDT01NRU5UICdEQVRFIE9GIExBU1QgQ09NUExFVEVEIFRSQURJTkcgREFZLicsCiBETV9TX1NZTUIgc3RyaW5nIE5PVCBOVUxMIENPTU1FTlQgJ1NFQ1VSSVRZIFNZTUJPTCBPRiBUSEUgU0VDVVJJVFknLAogRE1fQ0xPU0UgREVDSU1BTCAoIDggLAogMiApIE5PVCBOVUxMIENPTU1FTlQgJ0NMT1NJTkcgUFJJQ0UgT0YgVEhFIFNFQ1VSSVRZIE9OIFRISVMgREFZLicsCiBETV9ISUdIIERFQ0lNQUwgKCA4ICwKIDIgKSBOT1QgTlVMTCBDT01NRU5UICdISUdIRVNUIFBSSUNFIEZPUiBUSEUgU0VDVUlSSVRZIE9OIFRISVMgREFZLicsCiBETV9MT1cgREVDSU1BTCAoIDggLAogMiApIE5PVCBOVUxMIENPTU1FTlQgJ0xPV0VTVCBQUklDRSBGT1IgVEhFIFNFQ1VSSVRZIE9OIFRISVMgREFZLicsCiBETV9WT0wgSU5UIE5PVCBOVUxMIENPTU1FTlQgJ1ZPTFVNRSBPRiBUSEUgU0VDVVJJVFkgT04gVEhJUyBEQVkuJykKdXNpbmcgZGVsdGEgCmFzIHNlbGVjdAogX2MwOjpzdHJpbmcgRE1fREFURSwgX2MxOjpJTlQgRE1fU19TWU1CLCBfYzI6OkRBVEUgRE1fQ0xPU0UsCiBfYzM6OnN0cmluZyBETV9ISUdILCBfYzQ6OkRFQ0lNQUwoOCwgMikgRE1fTE9XLCBfYzU6OkRFQ0lNQUwoOCwgMikgRE1fVk9MCmZyb20gY2xvdWRfZmlsZXMoCiAgICAgICAgICAgICAgICAgInMzOi8vdHBjZGktZmlsZXMvdG1wL3RwY2RpL3NmPSR7dHBjZGlfc2NhbGV9L0JhdGNoMS9EYWlseU1hcmtldCIsCiAgICAgICAgICAgICAgICAgImNzdiIsCiAgICAgICAgICAgICAgICAgbWFwKCJpbmZlclNjaGVtYSIsICJGYWxzZSIsIAogICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgImhlYWRlciIsICJGYWxzZSIsCiAgICAgICAgICAgICAgICAgICAgICJkZWxpbWl0ZXIiLCAifCIpCiAgICAgICAgICAgICAgICAp",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_DAILYMARKET_I_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_dailymarket_stg\n(CDC_FLAG string COMMENT 'I DENOTES INSERT',\n CDC_DSN INT COMMENT 'DATABASE SEQUENCE NUMBER',\n DM_DATE DATE NOT NULL COMMENT 'DATE OF LAST COMPLETED TRADING DAY.',\n DM_S_SYMB string NOT NULL COMMENT 'SECURITY SYMBOL OF THE SECURITY',\n DM_CLOSE DECIMAL ( 8 ,\n 2 ) NOT NULL COMMENT 'CLOSING PRICE OF THE SECURITY ON THIS DAY.',\n DM_HIGH DECIMAL ( 8 ,\n 2 ) NOT NULL COMMENT 'HIGHEST PRICE FOR THE SECUIRITY ON THIS DAY.',\n DM_LOW DECIMAL ( 8 ,\n 2 ) NOT NULL COMMENT 'LOWEST PRICE FOR THE SECURITY ON THIS DAY.',\n DM_VOL INT NOT NULL COMMENT 'VOLUME OF THE SECURITY ON THIS DAY.')\nusing delta \nas select\n _c0::string CDC_FLAG, _c1::INT CDC_DSN, _c2::DATE DM_DATE,\n _c3::string DM_S_SYMB, _c4::DECIMAL(8, 2) DM_CLOSE, _c5::DECIMAL(8,\n 2) DM_HIGH, _c6::DECIMAL(8, 2) DM_LOW, _c7::INT DM_VOL\nfrom cloud_files(\n                 \"s3://tpcdi-files/tmp/tpcdi/sf=${tpcdi_scale}/Batch${batch_counter}/DailyMarket\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_dailymarket_i_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX2RhaWx5bWFya2V0X3N0ZwooQ0RDX0ZMQUcgc3RyaW5nIENPTU1FTlQgJ0kgREVOT1RFUyBJTlNFUlQnLAogQ0RDX0RTTiBJTlQgQ09NTUVOVCAnREFUQUJBU0UgU0VRVUVOQ0UgTlVNQkVSJywKIERNX0RBVEUgREFURSBOT1QgTlVMTCBDT01NRU5UICdEQVRFIE9GIExBU1QgQ09NUExFVEVEIFRSQURJTkcgREFZLicsCiBETV9TX1NZTUIgc3RyaW5nIE5PVCBOVUxMIENPTU1FTlQgJ1NFQ1VSSVRZIFNZTUJPTCBPRiBUSEUgU0VDVVJJVFknLAogRE1fQ0xPU0UgREVDSU1BTCAoIDggLAogMiApIE5PVCBOVUxMIENPTU1FTlQgJ0NMT1NJTkcgUFJJQ0UgT0YgVEhFIFNFQ1VSSVRZIE9OIFRISVMgREFZLicsCiBETV9ISUdIIERFQ0lNQUwgKCA4ICwKIDIgKSBOT1QgTlVMTCBDT01NRU5UICdISUdIRVNUIFBSSUNFIEZPUiBUSEUgU0VDVUlSSVRZIE9OIFRISVMgREFZLicsCiBETV9MT1cgREVDSU1BTCAoIDggLAogMiApIE5PVCBOVUxMIENPTU1FTlQgJ0xPV0VTVCBQUklDRSBGT1IgVEhFIFNFQ1VSSVRZIE9OIFRISVMgREFZLicsCiBETV9WT0wgSU5UIE5PVCBOVUxMIENPTU1FTlQgJ1ZPTFVNRSBPRiBUSEUgU0VDVVJJVFkgT04gVEhJUyBEQVkuJykKdXNpbmcgZGVsdGEgCmFzIHNlbGVjdAogX2MwOjpzdHJpbmcgQ0RDX0ZMQUcsIF9jMTo6SU5UIENEQ19EU04sIF9jMjo6REFURSBETV9EQVRFLAogX2MzOjpzdHJpbmcgRE1fU19TWU1CLCBfYzQ6OkRFQ0lNQUwoOCwgMikgRE1fQ0xPU0UsIF9jNTo6REVDSU1BTCg4LAogMikgRE1fSElHSCwgX2M2OjpERUNJTUFMKDgsIDIpIERNX0xPVywgX2M3OjpJTlQgRE1fVk9MCmZyb20gY2xvdWRfZmlsZXMoCiAgICAgICAgICAgICAgICAgInMzOi8vdHBjZGktZmlsZXMvdG1wL3RwY2RpL3NmPSR7dHBjZGlfc2NhbGV9L0JhdGNoJHtiYXRjaF9jb3VudGVyfS9EYWlseU1hcmtldCIsCiAgICAgICAgICAgICAgICAgImNzdiIsCiAgICAgICAgICAgICAgICAgbWFwKCJpbmZlclNjaGVtYSIsICJGYWxzZSIsIAogICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgImhlYWRlciIsICJGYWxzZSIsCiAgICAgICAgICAgICAgICAgICAgICJkZWxpbWl0ZXIiLCAifCIpCiAgICAgICAgICAgICAgICAp",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_DAILYMARKET_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_dailymarket_stg\n(CDC_FLAG string COMMENT 'I DENOTES INSERT',\n CDC_DSN INT COMMENT 'DATABASE SEQUENCE NUMBER',\n DM_DATE DATE NOT NULL COMMENT 'DATE OF LAST COMPLETED TRADING DAY.',\n DM_S_SYMB string NOT NULL COMMENT 'SECURITY SYMBOL OF THE SECURITY',\n DM_CLOSE DECIMAL ( 8 ,\n 2 ) NOT NULL COMMENT 'CLOSING PRICE OF THE SECURITY ON THIS DAY.',\n DM_HIGH DECIMAL ( 8 ,\n 2 ) NOT NULL COMMENT 'HIGHEST PRICE FOR THE SECUIRITY ON THIS DAY.',\n DM_LOW DECIMAL ( 8 ,\n 2 ) NOT NULL COMMENT 'LOWEST PRICE FOR THE SECURITY ON THIS DAY.',\n DM_VOL INT NOT NULL COMMENT 'VOLUME OF THE SECURITY ON THIS DAY.')\nusing delta \nas select\n _c0::string CDC_FLAG, _c1::INT CDC_DSN, _c2::DATE DM_DATE,\n _c3::string DM_S_SYMB, _c4::DECIMAL(8, 2) DM_CLOSE, _c5::DECIMAL(8,\n 2) DM_HIGH, _c6::DECIMAL(8, 2) DM_LOW, _c7::INT DM_VOL\nfrom cloud_files(\n                 \"s3://tpcdi-files/load/daily_market/\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_dailymarket_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX2RhaWx5bWFya2V0X3N0ZwooQ0RDX0ZMQUcgc3RyaW5nIENPTU1FTlQgJ0kgREVOT1RFUyBJTlNFUlQnLAogQ0RDX0RTTiBJTlQgQ09NTUVOVCAnREFUQUJBU0UgU0VRVUVOQ0UgTlVNQkVSJywKIERNX0RBVEUgREFURSBOT1QgTlVMTCBDT01NRU5UICdEQVRFIE9GIExBU1QgQ09NUExFVEVEIFRSQURJTkcgREFZLicsCiBETV9TX1NZTUIgc3RyaW5nIE5PVCBOVUxMIENPTU1FTlQgJ1NFQ1VSSVRZIFNZTUJPTCBPRiBUSEUgU0VDVVJJVFknLAogRE1fQ0xPU0UgREVDSU1BTCAoIDggLAogMiApIE5PVCBOVUxMIENPTU1FTlQgJ0NMT1NJTkcgUFJJQ0UgT0YgVEhFIFNFQ1VSSVRZIE9OIFRISVMgREFZLicsCiBETV9ISUdIIERFQ0lNQUwgKCA4ICwKIDIgKSBOT1QgTlVMTCBDT01NRU5UICdISUdIRVNUIFBSSUNFIEZPUiBUSEUgU0VDVUlSSVRZIE9OIFRISVMgREFZLicsCiBETV9MT1cgREVDSU1BTCAoIDggLAogMiApIE5PVCBOVUxMIENPTU1FTlQgJ0xPV0VTVCBQUklDRSBGT1IgVEhFIFNFQ1VSSVRZIE9OIFRISVMgREFZLicsCiBETV9WT0wgSU5UIE5PVCBOVUxMIENPTU1FTlQgJ1ZPTFVNRSBPRiBUSEUgU0VDVVJJVFkgT04gVEhJUyBEQVkuJykKdXNpbmcgZGVsdGEgCmFzIHNlbGVjdAogX2MwOjpzdHJpbmcgQ0RDX0ZMQUcsIF9jMTo6SU5UIENEQ19EU04sIF9jMjo6REFURSBETV9EQVRFLAogX2MzOjpzdHJpbmcgRE1fU19TWU1CLCBfYzQ6OkRFQ0lNQUwoOCwgMikgRE1fQ0xPU0UsIF9jNTo6REVDSU1BTCg4LAogMikgRE1fSElHSCwgX2M2OjpERUNJTUFMKDgsIDIpIERNX0xPVywgX2M3OjpJTlQgRE1fVk9MCmZyb20gY2xvdWRfZmlsZXMoCiAgICAgICAgICAgICAgICAgInMzOi8vdHBjZGktZmlsZXMvbG9hZC9kYWlseV9tYXJrZXQvIiwKICAgICAgICAgICAgICAgICAiY3N2IiwKICAgICAgICAgICAgICAgICBtYXAoImluZmVyU2NoZW1hIiwgIkZhbHNlIiwgCiAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAiaGVhZGVyIiwgIkZhbHNlIiwKICAgICAgICAgICAgICAgICAgICAgImRlbGltaXRlciIsICJ8IikKICAgICAgICAgICAgICAgICk=",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_DATE_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_date_stg\n(SK_DATEID INT NOT NULL COMMENT 'SURROGATE KEY FOR THE DATE',\n DATEVALUE string NOT NULL COMMENT 'THE DATE AS TEXT, E.G. \u201c2004-07-07\u201d',\n DATEDESC string NOT NULL COMMENT 'THE DATE MONTH DAY, YYYY, E.G. JULY 7,\n 2004',\n CALENDARYEARID DECIMAL ( 4 ) NOT NULL COMMENT 'YEAR NUMBER AS A NUMBER',\n CALENDARYEARDESC string NOT NULL COMMENT 'YEAR NUMBER AS TEXT',\n CALENDARQTRID DECIMAL ( 5 ) NOT NULL COMMENT 'QUARTER AS A NUMBER,\n E.G. 20042', CALENDARQTRDESC string NOT NULL COMMENT 'QUARTER AS TEXT,\n E.G. \u201c2004 Q2\u201d',\n CALENDARMONTHID DECIMAL ( 6 ) NOT NULL COMMENT 'MONTH AS A NUMBER,\n E.G. 20047', CALENDARMONTHDESC string NOT NULL COMMENT 'MONTH AS TEXT,\n E.G. \u201c2004 JULY\u201d',\n CALENDARWEEKID DECIMAL ( 6 ) NOT NULL COMMENT 'WEEK AS A NUMBER,\n E.G. 200428', CALENDARWEEKDESC string NOT NULL COMMENT 'WEEK AS TEXT,\n E.G. \u201c2004-W28\u201d',\n DAYOFWEEKNUM DECIMAL ( 1 ) NOT NULL COMMENT 'DAY OF WEEK AS A NUMBER,\n E.G. 3', DAYOFWEEKDESC string NOT NULL COMMENT 'DAY OF WEEK AS TEXT,\n E.G. \u201cWEDNESDAY\u201d',\n FISCALYEARID DECIMAL ( 4 ) NOT NULL COMMENT 'FISCAL YEAR AS A NUMBER,\n E.G. 2005', FISCALYEARDESC string NOT NULL COMMENT 'FISCAL YEAR AS TEXT,\n E.G. \u201c2005\u201d',\n FISCALQTRID DECIMAL ( 5 ) NOT NULL COMMENT 'FISCAL QUARTER AS A NUMBER,\n E.G. 20051', FISCALQTRDESC string NOT NULL COMMENT 'FISCAL QUARTER AS TEXT,\n E.G. \u201c2005 Q1\u201d', HOLIDAYFLAG BOOLEAN COMMENT 'INDICATES HOLIDAYS')\nusing delta \nas select\n _c0::INT SK_DATEID, _c1::string DATEVALUE, _c2::string DATEDESC,\n _c3::DECIMAL(4) CALENDARYEARID, _c4::string CALENDARYEARDESC,\n _c5::DECIMAL(5) CALENDARQTRID, _c6::string CALENDARQTRDESC,\n _c7::DECIMAL(6) CALENDARMONTHID, _c8::string CALENDARMONTHDESC,\n _c9::DECIMAL(6) CALENDARWEEKID, _c10::string CALENDARWEEKDESC,\n _c11::DECIMAL(1) DAYOFWEEKNUM, _c12::string DAYOFWEEKDESC,\n _c13::DECIMAL(4) FISCALYEARID, _c14::string FISCALYEARDESC,\n _c15::DECIMAL(5) FISCALQTRID, _c16::string FISCALQTRDESC,\n _c17::BOOLEAN HOLIDAYFLAG\nfrom cloud_files(\n                 \"s3://tpcdi-files/tmp/tpcdi/sf=${tpcdi_scale}/Batch1/Date.txt\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_date_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX2RhdGVfc3RnCihTS19EQVRFSUQgSU5UIE5PVCBOVUxMIENPTU1FTlQgJ1NVUlJPR0FURSBLRVkgRk9SIFRIRSBEQVRFJywKIERBVEVWQUxVRSBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnVEhFIERBVEUgQVMgVEVYVCwgRS5HLiDigJwyMDA0LTA3LTA34oCdJywKIERBVEVERVNDIHN0cmluZyBOT1QgTlVMTCBDT01NRU5UICdUSEUgREFURSBNT05USCBEQVksIFlZWVksIEUuRy4gSlVMWSA3LAogMjAwNCcsCiBDQUxFTkRBUllFQVJJRCBERUNJTUFMICggNCApIE5PVCBOVUxMIENPTU1FTlQgJ1lFQVIgTlVNQkVSIEFTIEEgTlVNQkVSJywKIENBTEVOREFSWUVBUkRFU0Mgc3RyaW5nIE5PVCBOVUxMIENPTU1FTlQgJ1lFQVIgTlVNQkVSIEFTIFRFWFQnLAogQ0FMRU5EQVJRVFJJRCBERUNJTUFMICggNSApIE5PVCBOVUxMIENPTU1FTlQgJ1FVQVJURVIgQVMgQSBOVU1CRVIsCiBFLkcuIDIwMDQyJywgQ0FMRU5EQVJRVFJERVNDIHN0cmluZyBOT1QgTlVMTCBDT01NRU5UICdRVUFSVEVSIEFTIFRFWFQsCiBFLkcuIOKAnDIwMDQgUTLigJ0nLAogQ0FMRU5EQVJNT05USElEIERFQ0lNQUwgKCA2ICkgTk9UIE5VTEwgQ09NTUVOVCAnTU9OVEggQVMgQSBOVU1CRVIsCiBFLkcuIDIwMDQ3JywgQ0FMRU5EQVJNT05USERFU0Mgc3RyaW5nIE5PVCBOVUxMIENPTU1FTlQgJ01PTlRIIEFTIFRFWFQsCiBFLkcuIOKAnDIwMDQgSlVMWeKAnScsCiBDQUxFTkRBUldFRUtJRCBERUNJTUFMICggNiApIE5PVCBOVUxMIENPTU1FTlQgJ1dFRUsgQVMgQSBOVU1CRVIsCiBFLkcuIDIwMDQyOCcsIENBTEVOREFSV0VFS0RFU0Mgc3RyaW5nIE5PVCBOVUxMIENPTU1FTlQgJ1dFRUsgQVMgVEVYVCwKIEUuRy4g4oCcMjAwNC1XMjjigJ0nLAogREFZT0ZXRUVLTlVNIERFQ0lNQUwgKCAxICkgTk9UIE5VTEwgQ09NTUVOVCAnREFZIE9GIFdFRUsgQVMgQSBOVU1CRVIsCiBFLkcuIDMnLCBEQVlPRldFRUtERVNDIHN0cmluZyBOT1QgTlVMTCBDT01NRU5UICdEQVkgT0YgV0VFSyBBUyBURVhULAogRS5HLiDigJxXRURORVNEQVnigJ0nLAogRklTQ0FMWUVBUklEIERFQ0lNQUwgKCA0ICkgTk9UIE5VTEwgQ09NTUVOVCAnRklTQ0FMIFlFQVIgQVMgQSBOVU1CRVIsCiBFLkcuIDIwMDUnLCBGSVNDQUxZRUFSREVTQyBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnRklTQ0FMIFlFQVIgQVMgVEVYVCwKIEUuRy4g4oCcMjAwNeKAnScsCiBGSVNDQUxRVFJJRCBERUNJTUFMICggNSApIE5PVCBOVUxMIENPTU1FTlQgJ0ZJU0NBTCBRVUFSVEVSIEFTIEEgTlVNQkVSLAogRS5HLiAyMDA1MScsIEZJU0NBTFFUUkRFU0Mgc3RyaW5nIE5PVCBOVUxMIENPTU1FTlQgJ0ZJU0NBTCBRVUFSVEVSIEFTIFRFWFQsCiBFLkcuIOKAnDIwMDUgUTHigJ0nLCBIT0xJREFZRkxBRyBCT09MRUFOIENPTU1FTlQgJ0lORElDQVRFUyBIT0xJREFZUycpCnVzaW5nIGRlbHRhIAphcyBzZWxlY3QKIF9jMDo6SU5UIFNLX0RBVEVJRCwgX2MxOjpzdHJpbmcgREFURVZBTFVFLCBfYzI6OnN0cmluZyBEQVRFREVTQywKIF9jMzo6REVDSU1BTCg0KSBDQUxFTkRBUllFQVJJRCwgX2M0OjpzdHJpbmcgQ0FMRU5EQVJZRUFSREVTQywKIF9jNTo6REVDSU1BTCg1KSBDQUxFTkRBUlFUUklELCBfYzY6OnN0cmluZyBDQUxFTkRBUlFUUkRFU0MsCiBfYzc6OkRFQ0lNQUwoNikgQ0FMRU5EQVJNT05USElELCBfYzg6OnN0cmluZyBDQUxFTkRBUk1PTlRIREVTQywKIF9jOTo6REVDSU1BTCg2KSBDQUxFTkRBUldFRUtJRCwgX2MxMDo6c3RyaW5nIENBTEVOREFSV0VFS0RFU0MsCiBfYzExOjpERUNJTUFMKDEpIERBWU9GV0VFS05VTSwgX2MxMjo6c3RyaW5nIERBWU9GV0VFS0RFU0MsCiBfYzEzOjpERUNJTUFMKDQpIEZJU0NBTFlFQVJJRCwgX2MxNDo6c3RyaW5nIEZJU0NBTFlFQVJERVNDLAogX2MxNTo6REVDSU1BTCg1KSBGSVNDQUxRVFJJRCwgX2MxNjo6c3RyaW5nIEZJU0NBTFFUUkRFU0MsCiBfYzE3OjpCT09MRUFOIEhPTElEQVlGTEFHCmZyb20gY2xvdWRfZmlsZXMoCiAgICAgICAgICAgICAgICAgInMzOi8vdHBjZGktZmlsZXMvdG1wL3RwY2RpL3NmPSR7dHBjZGlfc2NhbGV9L0JhdGNoMS9EYXRlLnR4dCIsCiAgICAgICAgICAgICAgICAgImNzdiIsCiAgICAgICAgICAgICAgICAgbWFwKCJpbmZlclNjaGVtYSIsICJGYWxzZSIsIAogICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgImhlYWRlciIsICJGYWxzZSIsCiAgICAgICAgICAgICAgICAgICAgICJkZWxpbWl0ZXIiLCAifCIpCiAgICAgICAgICAgICAgICAp",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_FINWIRE_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_finwire_stg\n(PTS STRING NOT NULL COMMENT 'POSTING DATE & TIME AS YYYYMMDD-HHMMSS - FIN,\n CMP, SEC', REC_TYPE STRING NOT NULL COMMENT '\u201cFIN\u201d, \"CMP\", OR \"SEC\" - FIN,\n CMP, SEC', COMPANY_NAME STRING NOT NULL COMMENT 'NAME OF THE COMPANY - CMP',\n CIK STRING NOT NULL COMMENT 'COMPANY IDENTIFICATION CODE FROM SEC - CMP',\n STATUS STRING NOT NULL COMMENT 'ACTV FOR ACTIVE COMPANY,\n INAC FOR INACTIVE - CMP, SEC',\n INDUSTRY_ID STRING NOT NULL COMMENT 'CODE FOR INDUSTRY SEGMENT - CMP',\n SP_RATING STRING NOT NULL COMMENT 'S&P RATING - CMP',\n FOUNDING_DATE STRING COMMENT 'A DATE AS YYYYMMDD - CMP',\n ADDR_LINE1 STRING NOT NULL COMMENT 'MAILING ADDRESS - CMP',\n ADDR_LINE2 STRING COMMENT 'MAILING ADDRESS - CMP',\n POSTAL_CODE STRING NOT NULL COMMENT 'MAILING ADDRESS - CMP',\n CITY STRING NOT NULL COMMENT 'MAILING ADDRESS - CMP',\n STATE_PROVINCE STRING NOT NULL COMMENT 'MAILING ADDRESS - CMP',\n COUNTRY STRING COMMENT 'MAILING ADDRESS - CMP',\n CEO_NAME STRING NOT NULL COMMENT 'NAME OF COMPANY CEO - CMP',\n DESCRIPTION STRING NOT NULL COMMENT 'DESCRIPTION OF THE COMPANY - CMP',\n YEAR STRING NOT NULL COMMENT 'YEAR OF THE QUARTER END. - FIN',\n QUARTER STRING NOT NULL COMMENT 'QUARTER NUMBER: VALID VALUES ARE 1, 2, 3,\n 4 - FIN', QTR_START_DATE STRING NOT NULL COMMENT 'START DATE OF QUARTER,\n AS YYYYMMDD - FIN',\n POSTING_DATE STRING NOT NULL COMMENT 'POSTING DATE OF QUARTERLY REPORT AS YYYYMMDD - FIN', REVENUE STRING NOT NULL COMMENT 'REPORTED REVENUE FOR THE QUARTER - FIN', EARNINGS STRING NOT NULL COMMENT 'NET EARNINGS REPORTED FOR THE QUARTER - FIN', EPS STRING NOT NULL COMMENT 'BASIC EARNINGS PER SHARE FOR THE QUARTER - FIN', DILUTED_EPS STRING NOT NULL COMMENT 'DILUTED EARNINGS PER SHARE FOR THE QUARTER - FIN', MARGIN STRING NOT NULL COMMENT 'PROFIT DIVIDED BY REVENUES FOR THE QUARTER - FIN', INVENTORY STRING NOT NULL COMMENT 'VALUE OF INVENTORY ON HAND AT END OF QUARTER - FIN', ASSETS STRING NOT NULL COMMENT 'VALUE OF TOTAL ASSETS AT THE END OF QUARTER - FIN', LIABILITIES STRING NOT NULL COMMENT 'VALUE OF TOTAL LIABILITIES AT THE END OF QUARTER - FIN', SH_OUT STRING NOT NULL COMMENT 'AVERAGE NUMBER OF SHARES OUTSTANDING - FIN, SEC', DILUTED_SH_OUT STRING NOT NULL COMMENT 'AVERAGE NUMBER OF SHARES OUTSTANDING (DILUTED) - FIN', CO_NAME_OR_CIK STRING NOT NULL COMMENT 'COMPANY CIK NUMBER (IF ONLY DIGITS, 10 VARCHARS) OR NAME (IF NOT ONLY DIGITS, 60 VARCHARS) - FIN, SEC', SYMBOL STRING NOT NULL COMMENT 'SECURITY SYMBOL - SEC', ISSUE_TYPE STRING NOT NULL COMMENT 'ISSUE TYPE - SEC', NAME STRING NOT NULL COMMENT 'SECURITY NAME - SEC', EX_ID STRING NOT NULL COMMENT 'ID OF THE EXCHANGE THE SECURITY IS TRADED ON - SEC', FIRST_TRADE_DATE STRING NOT NULL COMMENT 'DATE OF FIRST TRADE AS YYYYMMDD - SEC', FIRST_TRADE_EXCHG STRING NOT NULL COMMENT 'DATE OF FIRST TRADE ON EXCHANGE AS YYYYMMDD - SEC', DIVIDEND STRING NOT NULL COMMENT 'DIVIDEND AS VALUE_T - SEC')\nusing delta \nas select\n SUBSTR ( $1, 0, 15 ) PTS, SUBSTR ( $1, 16, 3 ) REC_TYPE, SUBSTR ( $1, 19,\n 60 ) COMPANY_NAME, SUBSTR ( $1, 79, 10 ) CIK, IFF ( SUBSTR ( $1, 16,\n 3 ) = ' CMP', SUBSTR ( $1, 89, 4 ), SUBSTR ( $1, 40, 4 ) ) STATUS,\n SUBSTR ( $1, 93, 2 ) INDUSTRY_ID, SUBSTR ( $1, 95, 4 ) SP_RATING,\n SUBSTR ( $1, 99, 8 ) FOUNDING_DATE, SUBSTR ( $1, 107, 80 ) ADDR_LINE1,\n SUBSTR ( $1, 187, 80 ) ADDR_LINE2, SUBSTR ( $1, 267, 12 ) POSTAL_CODE,\n SUBSTR ( $1, 279, 25 ) CITY, SUBSTR ( $1, 304, 20 ) STATE_PROVINCE,\n SUBSTR ( $1, 324, 24 ) COUNTRY, SUBSTR ( $1, 348, 46 ) CEO_NAME, SUBSTR ( $1,\n 394, 150 ) DESCRIPTION, SUBSTR ( $1, 19, 4 ) YEAR, SUBSTR ( $1, 23,\n 1 ) QUARTER, SUBSTR ( $1, 24, 8 ) QTR_START_DATE, SUBSTR ( $1, 32,\n 8 ) POSTING_DATE, SUBSTR ( $1, 40, 17 ) REVENUE, SUBSTR ( $1, 57,\n 17 ) EARNINGS, SUBSTR ( $1, 74, 12 ) EPS, SUBSTR ( $1, 86, 12 ) DILUTED_EPS,\n SUBSTR ( $1, 98, 12 ) MARGIN, SUBSTR ( $1, 110, 17 ) INVENTORY, SUBSTR ( $1,\n 127, 17 ) ASSETS, SUBSTR ( $1, 144, 17 ) LIABILITIES, IFF ( SUBSTR ( $1, 16,\n 3 ) = 'FIN', SUBSTR ( $1, 161, 13 ), SUBSTR ( $1, 120, 13 ) ) SH_OUT,\n SUBSTR ( $1, 174, 13 ) DILUTED_SH_OUT, IFF ( SUBSTR ( $1, 16, 3 ) = 'FIN',\n SUBSTR ( $1, 187, 60 ), SUBSTR ( $1, 161, 60 ) ) CO_NAME_OR_CIK, SUBSTR ( $1,\n 19, 15 ) SYMBOL, SUBSTR ( $1, 34, 6 ) ISSUE_TYPE, SUBSTR ( $1, 44, 70 ) NAME,\n SUBSTR ( $1, 114, 6 ) EX_ID, SUBSTR ( $1, 133, 8 ) FIRST_TRADE_DATE,\n SUBSTR ( $1, 141, 8 ) FIRST_TRADE_EXCHG, SUBSTR ( $1, 149, 12 ) DIVIDEND\nfrom cloud_files(\n                 \"s3://tpcdi-files/tmp/tpcdi/sf=${tpcdi_scale}/Batch${batch_counter}/FINWIRE\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"NONE\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_finwire_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX2ZpbndpcmVfc3RnCihQVFMgU1RSSU5HIE5PVCBOVUxMIENPTU1FTlQgJ1BPU1RJTkcgREFURSAmIFRJTUUgQVMgWVlZWU1NREQtSEhNTVNTIC0gRklOLAogQ01QLCBTRUMnLCBSRUNfVFlQRSBTVFJJTkcgTk9UIE5VTEwgQ09NTUVOVCAn4oCcRklO4oCdLCAiQ01QIiwgT1IgIlNFQyIgLSBGSU4sCiBDTVAsIFNFQycsIENPTVBBTllfTkFNRSBTVFJJTkcgTk9UIE5VTEwgQ09NTUVOVCAnTkFNRSBPRiBUSEUgQ09NUEFOWSAtIENNUCcsCiBDSUsgU1RSSU5HIE5PVCBOVUxMIENPTU1FTlQgJ0NPTVBBTlkgSURFTlRJRklDQVRJT04gQ09ERSBGUk9NIFNFQyAtIENNUCcsCiBTVEFUVVMgU1RSSU5HIE5PVCBOVUxMIENPTU1FTlQgJ0FDVFYgRk9SIEFDVElWRSBDT01QQU5ZLAogSU5BQyBGT1IgSU5BQ1RJVkUgLSBDTVAsIFNFQycsCiBJTkRVU1RSWV9JRCBTVFJJTkcgTk9UIE5VTEwgQ09NTUVOVCAnQ09ERSBGT1IgSU5EVVNUUlkgU0VHTUVOVCAtIENNUCcsCiBTUF9SQVRJTkcgU1RSSU5HIE5PVCBOVUxMIENPTU1FTlQgJ1MmUCBSQVRJTkcgLSBDTVAnLAogRk9VTkRJTkdfREFURSBTVFJJTkcgQ09NTUVOVCAnQSBEQVRFIEFTIFlZWVlNTUREIC0gQ01QJywKIEFERFJfTElORTEgU1RSSU5HIE5PVCBOVUxMIENPTU1FTlQgJ01BSUxJTkcgQUREUkVTUyAtIENNUCcsCiBBRERSX0xJTkUyIFNUUklORyBDT01NRU5UICdNQUlMSU5HIEFERFJFU1MgLSBDTVAnLAogUE9TVEFMX0NPREUgU1RSSU5HIE5PVCBOVUxMIENPTU1FTlQgJ01BSUxJTkcgQUREUkVTUyAtIENNUCcsCiBDSVRZIFNUUklORyBOT1QgTlVMTCBDT01NRU5UICdNQUlMSU5HIEFERFJFU1MgLSBDTVAnLAogU1RBVEVfUFJPVklOQ0UgU1RSSU5HIE5PVCBOVUxMIENPTU1FTlQgJ01BSUxJTkcgQUREUkVTUyAtIENNUCcsCiBDT1VOVFJZIFNUUklORyBDT01NRU5UICdNQUlMSU5HIEFERFJFU1MgLSBDTVAnLAogQ0VPX05BTUUgU1RSSU5HIE5PVCBOVUxMIENPTU1FTlQgJ05BTUUgT0YgQ09NUEFOWSBDRU8gLSBDTVAnLAogREVTQ1JJUFRJT04gU1RSSU5HIE5PVCBOVUxMIENPTU1FTlQgJ0RFU0NSSVBUSU9OIE9GIFRIRSBDT01QQU5ZIC0gQ01QJywKIFlFQVIgU1RSSU5HIE5PVCBOVUxMIENPTU1FTlQgJ1lFQVIgT0YgVEhFIFFVQVJURVIgRU5ELiAtIEZJTicsCiBRVUFSVEVSIFNUUklORyBOT1QgTlVMTCBDT01NRU5UICdRVUFSVEVSIE5VTUJFUjogVkFMSUQgVkFMVUVTIEFSRSAxLCAyLCAzLAogNCAtIEZJTicsIFFUUl9TVEFSVF9EQVRFIFNUUklORyBOT1QgTlVMTCBDT01NRU5UICdTVEFSVCBEQVRFIE9GIFFVQVJURVIsCiBBUyBZWVlZTU1ERCAtIEZJTicsCiBQT1NUSU5HX0RBVEUgU1RSSU5HIE5PVCBOVUxMIENPTU1FTlQgJ1BPU1RJTkcgREFURSBPRiBRVUFSVEVSTFkgUkVQT1JUIEFTIFlZWVlNTUREIC0gRklOJywgUkVWRU5VRSBTVFJJTkcgTk9UIE5VTEwgQ09NTUVOVCAnUkVQT1JURUQgUkVWRU5VRSBGT1IgVEhFIFFVQVJURVIgLSBGSU4nLCBFQVJOSU5HUyBTVFJJTkcgTk9UIE5VTEwgQ09NTUVOVCAnTkVUIEVBUk5JTkdTIFJFUE9SVEVEIEZPUiBUSEUgUVVBUlRFUiAtIEZJTicsIEVQUyBTVFJJTkcgTk9UIE5VTEwgQ09NTUVOVCAnQkFTSUMgRUFSTklOR1MgUEVSIFNIQVJFIEZPUiBUSEUgUVVBUlRFUiAtIEZJTicsIERJTFVURURfRVBTIFNUUklORyBOT1QgTlVMTCBDT01NRU5UICdESUxVVEVEIEVBUk5JTkdTIFBFUiBTSEFSRSBGT1IgVEhFIFFVQVJURVIgLSBGSU4nLCBNQVJHSU4gU1RSSU5HIE5PVCBOVUxMIENPTU1FTlQgJ1BST0ZJVCBESVZJREVEIEJZIFJFVkVOVUVTIEZPUiBUSEUgUVVBUlRFUiAtIEZJTicsIElOVkVOVE9SWSBTVFJJTkcgTk9UIE5VTEwgQ09NTUVOVCAnVkFMVUUgT0YgSU5WRU5UT1JZIE9OIEhBTkQgQVQgRU5EIE9GIFFVQVJURVIgLSBGSU4nLCBBU1NFVFMgU1RSSU5HIE5PVCBOVUxMIENPTU1FTlQgJ1ZBTFVFIE9GIFRPVEFMIEFTU0VUUyBBVCBUSEUgRU5EIE9GIFFVQVJURVIgLSBGSU4nLCBMSUFCSUxJVElFUyBTVFJJTkcgTk9UIE5VTEwgQ09NTUVOVCAnVkFMVUUgT0YgVE9UQUwgTElBQklMSVRJRVMgQVQgVEhFIEVORCBPRiBRVUFSVEVSIC0gRklOJywgU0hfT1VUIFNUUklORyBOT1QgTlVMTCBDT01NRU5UICdBVkVSQUdFIE5VTUJFUiBPRiBTSEFSRVMgT1VUU1RBTkRJTkcgLSBGSU4sIFNFQycsIERJTFVURURfU0hfT1VUIFNUUklORyBOT1QgTlVMTCBDT01NRU5UICdBVkVSQUdFIE5VTUJFUiBPRiBTSEFSRVMgT1VUU1RBTkRJTkcgKERJTFVURUQpIC0gRklOJywgQ09fTkFNRV9PUl9DSUsgU1RSSU5HIE5PVCBOVUxMIENPTU1FTlQgJ0NPTVBBTlkgQ0lLIE5VTUJFUiAoSUYgT05MWSBESUdJVFMsIDEwIFZBUkNIQVJTKSBPUiBOQU1FIChJRiBOT1QgT05MWSBESUdJVFMsIDYwIFZBUkNIQVJTKSAtIEZJTiwgU0VDJywgU1lNQk9MIFNUUklORyBOT1QgTlVMTCBDT01NRU5UICdTRUNVUklUWSBTWU1CT0wgLSBTRUMnLCBJU1NVRV9UWVBFIFNUUklORyBOT1QgTlVMTCBDT01NRU5UICdJU1NVRSBUWVBFIC0gU0VDJywgTkFNRSBTVFJJTkcgTk9UIE5VTEwgQ09NTUVOVCAnU0VDVVJJVFkgTkFNRSAtIFNFQycsIEVYX0lEIFNUUklORyBOT1QgTlVMTCBDT01NRU5UICdJRCBPRiBUSEUgRVhDSEFOR0UgVEhFIFNFQ1VSSVRZIElTIFRSQURFRCBPTiAtIFNFQycsIEZJUlNUX1RSQURFX0RBVEUgU1RSSU5HIE5PVCBOVUxMIENPTU1FTlQgJ0RBVEUgT0YgRklSU1QgVFJBREUgQVMgWVlZWU1NREQgLSBTRUMnLCBGSVJTVF9UUkFERV9FWENIRyBTVFJJTkcgTk9UIE5VTEwgQ09NTUVOVCAnREFURSBPRiBGSVJTVCBUUkFERSBPTiBFWENIQU5HRSBBUyBZWVlZTU1ERCAtIFNFQycsIERJVklERU5EIFNUUklORyBOT1QgTlVMTCBDT01NRU5UICdESVZJREVORCBBUyBWQUxVRV9UIC0gU0VDJykKdXNpbmcgZGVsdGEgCmFzIHNlbGVjdAogU1VCU1RSICggJDEsIDAsIDE1ICkgUFRTLCBTVUJTVFIgKCAkMSwgMTYsIDMgKSBSRUNfVFlQRSwgU1VCU1RSICggJDEsIDE5LAogNjAgKSBDT01QQU5ZX05BTUUsIFNVQlNUUiAoICQxLCA3OSwgMTAgKSBDSUssIElGRiAoIFNVQlNUUiAoICQxLCAxNiwKIDMgKSA9ICcgQ01QJywgU1VCU1RSICggJDEsIDg5LCA0ICksIFNVQlNUUiAoICQxLCA0MCwgNCApICkgU1RBVFVTLAogU1VCU1RSICggJDEsIDkzLCAyICkgSU5EVVNUUllfSUQsIFNVQlNUUiAoICQxLCA5NSwgNCApIFNQX1JBVElORywKIFNVQlNUUiAoICQxLCA5OSwgOCApIEZPVU5ESU5HX0RBVEUsIFNVQlNUUiAoICQxLCAxMDcsIDgwICkgQUREUl9MSU5FMSwKIFNVQlNUUiAoICQxLCAxODcsIDgwICkgQUREUl9MSU5FMiwgU1VCU1RSICggJDEsIDI2NywgMTIgKSBQT1NUQUxfQ09ERSwKIFNVQlNUUiAoICQxLCAyNzksIDI1ICkgQ0lUWSwgU1VCU1RSICggJDEsIDMwNCwgMjAgKSBTVEFURV9QUk9WSU5DRSwKIFNVQlNUUiAoICQxLCAzMjQsIDI0ICkgQ09VTlRSWSwgU1VCU1RSICggJDEsIDM0OCwgNDYgKSBDRU9fTkFNRSwgU1VCU1RSICggJDEsCiAzOTQsIDE1MCApIERFU0NSSVBUSU9OLCBTVUJTVFIgKCAkMSwgMTksIDQgKSBZRUFSLCBTVUJTVFIgKCAkMSwgMjMsCiAxICkgUVVBUlRFUiwgU1VCU1RSICggJDEsIDI0LCA4ICkgUVRSX1NUQVJUX0RBVEUsIFNVQlNUUiAoICQxLCAzMiwKIDggKSBQT1NUSU5HX0RBVEUsIFNVQlNUUiAoICQxLCA0MCwgMTcgKSBSRVZFTlVFLCBTVUJTVFIgKCAkMSwgNTcsCiAxNyApIEVBUk5JTkdTLCBTVUJTVFIgKCAkMSwgNzQsIDEyICkgRVBTLCBTVUJTVFIgKCAkMSwgODYsIDEyICkgRElMVVRFRF9FUFMsCiBTVUJTVFIgKCAkMSwgOTgsIDEyICkgTUFSR0lOLCBTVUJTVFIgKCAkMSwgMTEwLCAxNyApIElOVkVOVE9SWSwgU1VCU1RSICggJDEsCiAxMjcsIDE3ICkgQVNTRVRTLCBTVUJTVFIgKCAkMSwgMTQ0LCAxNyApIExJQUJJTElUSUVTLCBJRkYgKCBTVUJTVFIgKCAkMSwgMTYsCiAzICkgPSAnRklOJywgU1VCU1RSICggJDEsIDE2MSwgMTMgKSwgU1VCU1RSICggJDEsIDEyMCwgMTMgKSApIFNIX09VVCwKIFNVQlNUUiAoICQxLCAxNzQsIDEzICkgRElMVVRFRF9TSF9PVVQsIElGRiAoIFNVQlNUUiAoICQxLCAxNiwgMyApID0gJ0ZJTicsCiBTVUJTVFIgKCAkMSwgMTg3LCA2MCApLCBTVUJTVFIgKCAkMSwgMTYxLCA2MCApICkgQ09fTkFNRV9PUl9DSUssIFNVQlNUUiAoICQxLAogMTksIDE1ICkgU1lNQk9MLCBTVUJTVFIgKCAkMSwgMzQsIDYgKSBJU1NVRV9UWVBFLCBTVUJTVFIgKCAkMSwgNDQsIDcwICkgTkFNRSwKIFNVQlNUUiAoICQxLCAxMTQsIDYgKSBFWF9JRCwgU1VCU1RSICggJDEsIDEzMywgOCApIEZJUlNUX1RSQURFX0RBVEUsCiBTVUJTVFIgKCAkMSwgMTQxLCA4ICkgRklSU1RfVFJBREVfRVhDSEcsIFNVQlNUUiAoICQxLCAxNDksIDEyICkgRElWSURFTkQKZnJvbSBjbG91ZF9maWxlcygKICAgICAgICAgICAgICAgICAiczM6Ly90cGNkaS1maWxlcy90bXAvdHBjZGkvc2Y9JHt0cGNkaV9zY2FsZX0vQmF0Y2gke2JhdGNoX2NvdW50ZXJ9L0ZJTldJUkUiLAogICAgICAgICAgICAgICAgICJjc3YiLAogICAgICAgICAgICAgICAgIG1hcCgiaW5mZXJTY2hlbWEiLCAiRmFsc2UiLCAKICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICJoZWFkZXIiLCAiRmFsc2UiLAogICAgICAgICAgICAgICAgICAgICAiZGVsaW1pdGVyIiwgIk5PTkUiKQogICAgICAgICAgICAgICAgKQ==",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_HOLDING_HISTORY_H_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_holdinghistory_stg\n(CDC_FLAG string COMMENT 'I DENOTES INSERT',\n CDC_DSN INT COMMENT 'DATABASE SEQUENCE NUMBER',\n HH_H_T_ID DECIMAL ( 15 ) NOT NULL COMMENT 'TRADE IDENTIFIER OF THE TRADE THAT ORIGINALLY CREATED THE HOLDING ROW.', HH_T_ID DECIMAL ( 15 ) NOT NULL COMMENT 'TRADE IDENTIFIER OF THE CURRENT TRADE', HH_BEFORE_QTY DECIMAL ( 6 ) NOT NULL COMMENT 'QUANTITY OF THIS SECURITY HELD BEFORE THE MODIFYING TRADE.', HH_AFTER_QTY DECIMAL ( 6 ) NOT NULL COMMENT 'QUANTITY OF THIS SECURITY HELD AFTER THE MODIFYING TRADE.')\nusing delta \nas select\n _c0::string HH_H_T_ID, _c1::INT HH_T_ID, _c2::DECIMAL(15) HH_BEFORE_QTY,\n _c3::DECIMAL(15) HH_AFTER_QTY\nfrom cloud_files(\n                 \"s3://tpcdi-files/tmp/tpcdi/sf=${tpcdi_scale}/Batch1/HoldingHistory\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_holding_history_h_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX2hvbGRpbmdoaXN0b3J5X3N0ZwooQ0RDX0ZMQUcgc3RyaW5nIENPTU1FTlQgJ0kgREVOT1RFUyBJTlNFUlQnLAogQ0RDX0RTTiBJTlQgQ09NTUVOVCAnREFUQUJBU0UgU0VRVUVOQ0UgTlVNQkVSJywKIEhIX0hfVF9JRCBERUNJTUFMICggMTUgKSBOT1QgTlVMTCBDT01NRU5UICdUUkFERSBJREVOVElGSUVSIE9GIFRIRSBUUkFERSBUSEFUIE9SSUdJTkFMTFkgQ1JFQVRFRCBUSEUgSE9MRElORyBST1cuJywgSEhfVF9JRCBERUNJTUFMICggMTUgKSBOT1QgTlVMTCBDT01NRU5UICdUUkFERSBJREVOVElGSUVSIE9GIFRIRSBDVVJSRU5UIFRSQURFJywgSEhfQkVGT1JFX1FUWSBERUNJTUFMICggNiApIE5PVCBOVUxMIENPTU1FTlQgJ1FVQU5USVRZIE9GIFRISVMgU0VDVVJJVFkgSEVMRCBCRUZPUkUgVEhFIE1PRElGWUlORyBUUkFERS4nLCBISF9BRlRFUl9RVFkgREVDSU1BTCAoIDYgKSBOT1QgTlVMTCBDT01NRU5UICdRVUFOVElUWSBPRiBUSElTIFNFQ1VSSVRZIEhFTEQgQUZURVIgVEhFIE1PRElGWUlORyBUUkFERS4nKQp1c2luZyBkZWx0YSAKYXMgc2VsZWN0CiBfYzA6OnN0cmluZyBISF9IX1RfSUQsIF9jMTo6SU5UIEhIX1RfSUQsIF9jMjo6REVDSU1BTCgxNSkgSEhfQkVGT1JFX1FUWSwKIF9jMzo6REVDSU1BTCgxNSkgSEhfQUZURVJfUVRZCmZyb20gY2xvdWRfZmlsZXMoCiAgICAgICAgICAgICAgICAgInMzOi8vdHBjZGktZmlsZXMvdG1wL3RwY2RpL3NmPSR7dHBjZGlfc2NhbGV9L0JhdGNoMS9Ib2xkaW5nSGlzdG9yeSIsCiAgICAgICAgICAgICAgICAgImNzdiIsCiAgICAgICAgICAgICAgICAgbWFwKCJpbmZlclNjaGVtYSIsICJGYWxzZSIsIAogICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgImhlYWRlciIsICJGYWxzZSIsCiAgICAgICAgICAgICAgICAgICAgICJkZWxpbWl0ZXIiLCAifCIpCiAgICAgICAgICAgICAgICAp",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_HOLDING_HISTORY_I_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_holdinghistory_stg\n(CDC_FLAG string COMMENT 'I DENOTES INSERT',\n CDC_DSN INT COMMENT 'DATABASE SEQUENCE NUMBER',\n HH_H_T_ID DECIMAL ( 15 ) NOT NULL COMMENT 'TRADE IDENTIFIER OF THE TRADE THAT ORIGINALLY CREATED THE HOLDING ROW.', HH_T_ID DECIMAL ( 15 ) NOT NULL COMMENT 'TRADE IDENTIFIER OF THE CURRENT TRADE', HH_BEFORE_QTY DECIMAL ( 6 ) NOT NULL COMMENT 'QUANTITY OF THIS SECURITY HELD BEFORE THE MODIFYING TRADE.', HH_AFTER_QTY DECIMAL ( 6 ) NOT NULL COMMENT 'QUANTITY OF THIS SECURITY HELD AFTER THE MODIFYING TRADE.')\nusing delta \nas select\n _c0::string CDC_FLAG, _c1::INT CDC_DSN, _c2::DECIMAL(15) HH_H_T_ID,\n _c3::DECIMAL(15) HH_T_ID, _c4::DECIMAL(6) HH_BEFORE_QTY,\n _c5::DECIMAL(6) HH_AFTER_QTY\nfrom cloud_files(\n                 \"s3://tpcdi-files/tmp/tpcdi/sf=${tpcdi_scale}/Batch${batch_counter}/HoldingHistory\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_holding_history_i_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX2hvbGRpbmdoaXN0b3J5X3N0ZwooQ0RDX0ZMQUcgc3RyaW5nIENPTU1FTlQgJ0kgREVOT1RFUyBJTlNFUlQnLAogQ0RDX0RTTiBJTlQgQ09NTUVOVCAnREFUQUJBU0UgU0VRVUVOQ0UgTlVNQkVSJywKIEhIX0hfVF9JRCBERUNJTUFMICggMTUgKSBOT1QgTlVMTCBDT01NRU5UICdUUkFERSBJREVOVElGSUVSIE9GIFRIRSBUUkFERSBUSEFUIE9SSUdJTkFMTFkgQ1JFQVRFRCBUSEUgSE9MRElORyBST1cuJywgSEhfVF9JRCBERUNJTUFMICggMTUgKSBOT1QgTlVMTCBDT01NRU5UICdUUkFERSBJREVOVElGSUVSIE9GIFRIRSBDVVJSRU5UIFRSQURFJywgSEhfQkVGT1JFX1FUWSBERUNJTUFMICggNiApIE5PVCBOVUxMIENPTU1FTlQgJ1FVQU5USVRZIE9GIFRISVMgU0VDVVJJVFkgSEVMRCBCRUZPUkUgVEhFIE1PRElGWUlORyBUUkFERS4nLCBISF9BRlRFUl9RVFkgREVDSU1BTCAoIDYgKSBOT1QgTlVMTCBDT01NRU5UICdRVUFOVElUWSBPRiBUSElTIFNFQ1VSSVRZIEhFTEQgQUZURVIgVEhFIE1PRElGWUlORyBUUkFERS4nKQp1c2luZyBkZWx0YSAKYXMgc2VsZWN0CiBfYzA6OnN0cmluZyBDRENfRkxBRywgX2MxOjpJTlQgQ0RDX0RTTiwgX2MyOjpERUNJTUFMKDE1KSBISF9IX1RfSUQsCiBfYzM6OkRFQ0lNQUwoMTUpIEhIX1RfSUQsIF9jNDo6REVDSU1BTCg2KSBISF9CRUZPUkVfUVRZLAogX2M1OjpERUNJTUFMKDYpIEhIX0FGVEVSX1FUWQpmcm9tIGNsb3VkX2ZpbGVzKAogICAgICAgICAgICAgICAgICJzMzovL3RwY2RpLWZpbGVzL3RtcC90cGNkaS9zZj0ke3RwY2RpX3NjYWxlfS9CYXRjaCR7YmF0Y2hfY291bnRlcn0vSG9sZGluZ0hpc3RvcnkiLAogICAgICAgICAgICAgICAgICJjc3YiLAogICAgICAgICAgICAgICAgIG1hcCgiaW5mZXJTY2hlbWEiLCAiRmFsc2UiLCAKICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICJoZWFkZXIiLCAiRmFsc2UiLAogICAgICAgICAgICAgICAgICAgICAiZGVsaW1pdGVyIiwgInwiKQogICAgICAgICAgICAgICAgKQ==",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_HOLDING_HISTORY_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_holdinghistory_stg\n(CDC_FLAG string COMMENT 'I DENOTES INSERT',\n CDC_DSN INT COMMENT 'DATABASE SEQUENCE NUMBER',\n HH_H_T_ID DECIMAL ( 15 ) NOT NULL COMMENT 'TRADE IDENTIFIER OF THE TRADE THAT ORIGINALLY CREATED THE HOLDING ROW.', HH_T_ID DECIMAL ( 15 ) NOT NULL COMMENT 'TRADE IDENTIFIER OF THE CURRENT TRADE', HH_BEFORE_QTY DECIMAL ( 6 ) NOT NULL COMMENT 'QUANTITY OF THIS SECURITY HELD BEFORE THE MODIFYING TRADE.', HH_AFTER_QTY DECIMAL ( 6 ) NOT NULL COMMENT 'QUANTITY OF THIS SECURITY HELD AFTER THE MODIFYING TRADE.')\nusing delta \nas select\n _c0::string CDC_FLAG, _c1::INT CDC_DSN, _c2::DECIMAL(15) HH_H_T_ID,\n _c3::DECIMAL(15) HH_T_ID, _c4::DECIMAL(6) HH_BEFORE_QTY,\n _c5::DECIMAL(6) HH_AFTER_QTY\nfrom cloud_files(\n                 \"s3://tpcdi-files/load/holding_history/\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_holding_history_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX2hvbGRpbmdoaXN0b3J5X3N0ZwooQ0RDX0ZMQUcgc3RyaW5nIENPTU1FTlQgJ0kgREVOT1RFUyBJTlNFUlQnLAogQ0RDX0RTTiBJTlQgQ09NTUVOVCAnREFUQUJBU0UgU0VRVUVOQ0UgTlVNQkVSJywKIEhIX0hfVF9JRCBERUNJTUFMICggMTUgKSBOT1QgTlVMTCBDT01NRU5UICdUUkFERSBJREVOVElGSUVSIE9GIFRIRSBUUkFERSBUSEFUIE9SSUdJTkFMTFkgQ1JFQVRFRCBUSEUgSE9MRElORyBST1cuJywgSEhfVF9JRCBERUNJTUFMICggMTUgKSBOT1QgTlVMTCBDT01NRU5UICdUUkFERSBJREVOVElGSUVSIE9GIFRIRSBDVVJSRU5UIFRSQURFJywgSEhfQkVGT1JFX1FUWSBERUNJTUFMICggNiApIE5PVCBOVUxMIENPTU1FTlQgJ1FVQU5USVRZIE9GIFRISVMgU0VDVVJJVFkgSEVMRCBCRUZPUkUgVEhFIE1PRElGWUlORyBUUkFERS4nLCBISF9BRlRFUl9RVFkgREVDSU1BTCAoIDYgKSBOT1QgTlVMTCBDT01NRU5UICdRVUFOVElUWSBPRiBUSElTIFNFQ1VSSVRZIEhFTEQgQUZURVIgVEhFIE1PRElGWUlORyBUUkFERS4nKQp1c2luZyBkZWx0YSAKYXMgc2VsZWN0CiBfYzA6OnN0cmluZyBDRENfRkxBRywgX2MxOjpJTlQgQ0RDX0RTTiwgX2MyOjpERUNJTUFMKDE1KSBISF9IX1RfSUQsCiBfYzM6OkRFQ0lNQUwoMTUpIEhIX1RfSUQsIF9jNDo6REVDSU1BTCg2KSBISF9CRUZPUkVfUVRZLAogX2M1OjpERUNJTUFMKDYpIEhIX0FGVEVSX1FUWQpmcm9tIGNsb3VkX2ZpbGVzKAogICAgICAgICAgICAgICAgICJzMzovL3RwY2RpLWZpbGVzL2xvYWQvaG9sZGluZ19oaXN0b3J5LyIsCiAgICAgICAgICAgICAgICAgImNzdiIsCiAgICAgICAgICAgICAgICAgbWFwKCJpbmZlclNjaGVtYSIsICJGYWxzZSIsIAogICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgImhlYWRlciIsICJGYWxzZSIsCiAgICAgICAgICAgICAgICAgICAgICJkZWxpbWl0ZXIiLCAifCIpCiAgICAgICAgICAgICAgICAp",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_HR_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_hr_stg\n(EMPLOYEEID DECIMAL ( 11 ) NOT NULL COMMENT 'ID OF EMPLOYEE',\n MANAGERID DECIMAL ( 11 ) NOT NULL COMMENT 'ID OF EMPLOYEE''S MANAGER',\n EMPLOYEEFIRSTNAME string NOT NULL COMMENT 'FIRST NAME',\n EMPLOYEELASTNAME string NOT NULL COMMENT 'LAST NAME',\n EMPLOYEEMI string COMMENT 'MIDDLE INITIAL',\n EMPLOYEEJOBCODE DECIMAL ( 3 ) COMMENT 'NUMERIC JOB CODE',\n EMPLOYEEBRANCH string COMMENT 'FACILITY IN WHICH EMPLOYEE HAS OFFICE',\n EMPLOYEEOFFICE string COMMENT 'OFFICE NUMBER OR DESCRIPTION',\n EMPLOYEEPHONE string COMMENT 'EMPLOYEE PHONE NUMBER')\nusing delta \nas select\n _c0::DECIMAL(11) EMPLOYEEID, _c1::DECIMAL(11) MANAGERID,\n _c2::string EMPLOYEEFIRSTNAME, _c3::string EMPLOYEELASTNAME,\n _c4::string EMPLOYEEMI, _c5::DECIMAL(3) EMPLOYEEJOBCODE,\n _c6::string EMPLOYEEBRANCH, _c7::string EMPLOYEEOFFICE,\n _c8::string EMPLOYEEPHONE\nfrom cloud_files(\n                 \"s3://tpcdi-files/tmp/tpcdi/sf=${tpcdi_scale}/Batch1/HR\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \",\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_hr_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX2hyX3N0ZwooRU1QTE9ZRUVJRCBERUNJTUFMICggMTEgKSBOT1QgTlVMTCBDT01NRU5UICdJRCBPRiBFTVBMT1lFRScsCiBNQU5BR0VSSUQgREVDSU1BTCAoIDExICkgTk9UIE5VTEwgQ09NTUVOVCAnSUQgT0YgRU1QTE9ZRUUnJ1MgTUFOQUdFUicsCiBFTVBMT1lFRUZJUlNUTkFNRSBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnRklSU1QgTkFNRScsCiBFTVBMT1lFRUxBU1ROQU1FIHN0cmluZyBOT1QgTlVMTCBDT01NRU5UICdMQVNUIE5BTUUnLAogRU1QTE9ZRUVNSSBzdHJpbmcgQ09NTUVOVCAnTUlERExFIElOSVRJQUwnLAogRU1QTE9ZRUVKT0JDT0RFIERFQ0lNQUwgKCAzICkgQ09NTUVOVCAnTlVNRVJJQyBKT0IgQ09ERScsCiBFTVBMT1lFRUJSQU5DSCBzdHJpbmcgQ09NTUVOVCAnRkFDSUxJVFkgSU4gV0hJQ0ggRU1QTE9ZRUUgSEFTIE9GRklDRScsCiBFTVBMT1lFRU9GRklDRSBzdHJpbmcgQ09NTUVOVCAnT0ZGSUNFIE5VTUJFUiBPUiBERVNDUklQVElPTicsCiBFTVBMT1lFRVBIT05FIHN0cmluZyBDT01NRU5UICdFTVBMT1lFRSBQSE9ORSBOVU1CRVInKQp1c2luZyBkZWx0YSAKYXMgc2VsZWN0CiBfYzA6OkRFQ0lNQUwoMTEpIEVNUExPWUVFSUQsIF9jMTo6REVDSU1BTCgxMSkgTUFOQUdFUklELAogX2MyOjpzdHJpbmcgRU1QTE9ZRUVGSVJTVE5BTUUsIF9jMzo6c3RyaW5nIEVNUExPWUVFTEFTVE5BTUUsCiBfYzQ6OnN0cmluZyBFTVBMT1lFRU1JLCBfYzU6OkRFQ0lNQUwoMykgRU1QTE9ZRUVKT0JDT0RFLAogX2M2OjpzdHJpbmcgRU1QTE9ZRUVCUkFOQ0gsIF9jNzo6c3RyaW5nIEVNUExPWUVFT0ZGSUNFLAogX2M4OjpzdHJpbmcgRU1QTE9ZRUVQSE9ORQpmcm9tIGNsb3VkX2ZpbGVzKAogICAgICAgICAgICAgICAgICJzMzovL3RwY2RpLWZpbGVzL3RtcC90cGNkaS9zZj0ke3RwY2RpX3NjYWxlfS9CYXRjaDEvSFIiLAogICAgICAgICAgICAgICAgICJjc3YiLAogICAgICAgICAgICAgICAgIG1hcCgiaW5mZXJTY2hlbWEiLCAiRmFsc2UiLCAKICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICJoZWFkZXIiLCAiRmFsc2UiLAogICAgICAgICAgICAgICAgICAgICAiZGVsaW1pdGVyIiwgIiwiKQogICAgICAgICAgICAgICAgKQ==",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_INDUSTRY_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_industry_stg\n(IN_ID string NOT NULL COMMENT 'INDUSTRY CODE',\n IN_NAME string NOT NULL COMMENT 'INDUSTRY DESCRIPTION',\n IN_SC_ID string NOT NULL COMMENT 'SECTOR IDENTIFIER')\nusing delta \nas select\n _c0::string IN_ID, _c1::string IN_NAME, _c2::string IN_SC_ID\nfrom cloud_files(\n                 \"s3://tpcdi-files/tmp/tpcdi/sf=${tpcdi_scale}/Batch1/Industry.txt\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_industry_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX2luZHVzdHJ5X3N0ZwooSU5fSUQgc3RyaW5nIE5PVCBOVUxMIENPTU1FTlQgJ0lORFVTVFJZIENPREUnLAogSU5fTkFNRSBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnSU5EVVNUUlkgREVTQ1JJUFRJT04nLAogSU5fU0NfSUQgc3RyaW5nIE5PVCBOVUxMIENPTU1FTlQgJ1NFQ1RPUiBJREVOVElGSUVSJykKdXNpbmcgZGVsdGEgCmFzIHNlbGVjdAogX2MwOjpzdHJpbmcgSU5fSUQsIF9jMTo6c3RyaW5nIElOX05BTUUsIF9jMjo6c3RyaW5nIElOX1NDX0lECmZyb20gY2xvdWRfZmlsZXMoCiAgICAgICAgICAgICAgICAgInMzOi8vdHBjZGktZmlsZXMvdG1wL3RwY2RpL3NmPSR7dHBjZGlfc2NhbGV9L0JhdGNoMS9JbmR1c3RyeS50eHQiLAogICAgICAgICAgICAgICAgICJjc3YiLAogICAgICAgICAgICAgICAgIG1hcCgiaW5mZXJTY2hlbWEiLCAiRmFsc2UiLCAKICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICJoZWFkZXIiLCAiRmFsc2UiLAogICAgICAgICAgICAgICAgICAgICAiZGVsaW1pdGVyIiwgInwiKQogICAgICAgICAgICAgICAgKQ==",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_PROSPECT_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_prospect_stg\n(AGENCYID string NOT NULL COMMENT 'UNIQUE IDENTIFIER FROM AGENCY',\n LASTNAME string NOT NULL COMMENT 'LAST NAME',\n FIRSTNAME string NOT NULL COMMENT 'FIRST NAME',\n MIDDLEINITIAL string COMMENT 'MIDDLE INITIAL',\n GENDER string COMMENT '''M'' OR ''F'' OR ''U''',\n ADDRESSLINE1 string COMMENT 'POSTAL ADDRESS',\n ADDRESSLINE2 string COMMENT 'POSTAL ADDRESS',\n POSTALCODE string COMMENT 'POSTAL CODE', CITY string NOT NULL COMMENT 'CITY',\n STATE string NOT NULL COMMENT 'STATE OR PROVINCE',\n COUNTRY string COMMENT 'POSTAL COUNTRY',\n PHONE string COMMENT 'TELEPHONE NUMBER',\n INCOME DECIMAL ( 9 ) COMMENT 'ANNUAL INCOME',\n NUMBERCARS DECIMAL ( 2 ) COMMENT 'CARS OWNED',\n NUMBERCHILDREN DECIMAL ( 2 ) COMMENT 'DEPENDENT CHILDREN',\n MARITALSTATUS string COMMENT '''S'' OR ''M'' OR ''D'' OR ''W'' OR ''U''',\n AGE DECIMAL ( 3 ) COMMENT 'CURRENT AGE',\n CREDITRATING DECIMAL ( 4 ) COMMENT 'NUMERIC RATING',\n OWNORRENTFLAG string COMMENT '''O'' OR ''R'' OR ''U''',\n EMPLOYER string COMMENT 'NAME OF EMPLOYER',\n NUMBERCREDITCARDS DECIMAL ( 2 ) COMMENT 'CREDIT CARDS',\n NETWORTH DECIMAL ( 12 ) COMMENT 'ESTIMATED TOTAL NET WORTH')\nusing delta \nas select\n _c0::string AGENCYID, _c1::string LASTNAME, _c2::string FIRSTNAME,\n _c3::string MIDDLEINITIAL, _c4::string GENDER, _c5::string ADDRESSLINE1,\n _c6::string ADDRESSLINE2, _c7::string POSTALCODE, _c8::string CITY,\n _c9::string STATE, _c10::string COUNTRY, _c11::string PHONE,\n _c12::DECIMAL(9) INCOME, _c13::DECIMAL(2) NUMBERCARS,\n _c14::DECIMAL(2) NUMBERCHILDREN, _c15::string MARITALSTATUS,\n _c16::DECIMAL(3) AGE, _c17::DECIMAL(4) CREDITRATING,\n _c18::string OWNORRENTFLAG, _c19::string EMPLOYER,\n _c20::DECIMAL(2) NUMBERCREDITCARDS, _c21::DECIMAL(12) NETWORTH\nfrom cloud_files(\n                 \"s3://tpcdi-files/tmp/tpcdi/sf=${tpcdi_scale}/Batch${file_counter}/Prospect\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \",\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_prospect_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX3Byb3NwZWN0X3N0ZwooQUdFTkNZSUQgc3RyaW5nIE5PVCBOVUxMIENPTU1FTlQgJ1VOSVFVRSBJREVOVElGSUVSIEZST00gQUdFTkNZJywKIExBU1ROQU1FIHN0cmluZyBOT1QgTlVMTCBDT01NRU5UICdMQVNUIE5BTUUnLAogRklSU1ROQU1FIHN0cmluZyBOT1QgTlVMTCBDT01NRU5UICdGSVJTVCBOQU1FJywKIE1JRERMRUlOSVRJQUwgc3RyaW5nIENPTU1FTlQgJ01JRERMRSBJTklUSUFMJywKIEdFTkRFUiBzdHJpbmcgQ09NTUVOVCAnJydNJycgT1IgJydGJycgT1IgJydVJycnLAogQUREUkVTU0xJTkUxIHN0cmluZyBDT01NRU5UICdQT1NUQUwgQUREUkVTUycsCiBBRERSRVNTTElORTIgc3RyaW5nIENPTU1FTlQgJ1BPU1RBTCBBRERSRVNTJywKIFBPU1RBTENPREUgc3RyaW5nIENPTU1FTlQgJ1BPU1RBTCBDT0RFJywgQ0lUWSBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnQ0lUWScsCiBTVEFURSBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnU1RBVEUgT1IgUFJPVklOQ0UnLAogQ09VTlRSWSBzdHJpbmcgQ09NTUVOVCAnUE9TVEFMIENPVU5UUlknLAogUEhPTkUgc3RyaW5nIENPTU1FTlQgJ1RFTEVQSE9ORSBOVU1CRVInLAogSU5DT01FIERFQ0lNQUwgKCA5ICkgQ09NTUVOVCAnQU5OVUFMIElOQ09NRScsCiBOVU1CRVJDQVJTIERFQ0lNQUwgKCAyICkgQ09NTUVOVCAnQ0FSUyBPV05FRCcsCiBOVU1CRVJDSElMRFJFTiBERUNJTUFMICggMiApIENPTU1FTlQgJ0RFUEVOREVOVCBDSElMRFJFTicsCiBNQVJJVEFMU1RBVFVTIHN0cmluZyBDT01NRU5UICcnJ1MnJyBPUiAnJ00nJyBPUiAnJ0QnJyBPUiAnJ1cnJyBPUiAnJ1UnJycsCiBBR0UgREVDSU1BTCAoIDMgKSBDT01NRU5UICdDVVJSRU5UIEFHRScsCiBDUkVESVRSQVRJTkcgREVDSU1BTCAoIDQgKSBDT01NRU5UICdOVU1FUklDIFJBVElORycsCiBPV05PUlJFTlRGTEFHIHN0cmluZyBDT01NRU5UICcnJ08nJyBPUiAnJ1InJyBPUiAnJ1UnJycsCiBFTVBMT1lFUiBzdHJpbmcgQ09NTUVOVCAnTkFNRSBPRiBFTVBMT1lFUicsCiBOVU1CRVJDUkVESVRDQVJEUyBERUNJTUFMICggMiApIENPTU1FTlQgJ0NSRURJVCBDQVJEUycsCiBORVRXT1JUSCBERUNJTUFMICggMTIgKSBDT01NRU5UICdFU1RJTUFURUQgVE9UQUwgTkVUIFdPUlRIJykKdXNpbmcgZGVsdGEgCmFzIHNlbGVjdAogX2MwOjpzdHJpbmcgQUdFTkNZSUQsIF9jMTo6c3RyaW5nIExBU1ROQU1FLCBfYzI6OnN0cmluZyBGSVJTVE5BTUUsCiBfYzM6OnN0cmluZyBNSURETEVJTklUSUFMLCBfYzQ6OnN0cmluZyBHRU5ERVIsIF9jNTo6c3RyaW5nIEFERFJFU1NMSU5FMSwKIF9jNjo6c3RyaW5nIEFERFJFU1NMSU5FMiwgX2M3OjpzdHJpbmcgUE9TVEFMQ09ERSwgX2M4OjpzdHJpbmcgQ0lUWSwKIF9jOTo6c3RyaW5nIFNUQVRFLCBfYzEwOjpzdHJpbmcgQ09VTlRSWSwgX2MxMTo6c3RyaW5nIFBIT05FLAogX2MxMjo6REVDSU1BTCg5KSBJTkNPTUUsIF9jMTM6OkRFQ0lNQUwoMikgTlVNQkVSQ0FSUywKIF9jMTQ6OkRFQ0lNQUwoMikgTlVNQkVSQ0hJTERSRU4sIF9jMTU6OnN0cmluZyBNQVJJVEFMU1RBVFVTLAogX2MxNjo6REVDSU1BTCgzKSBBR0UsIF9jMTc6OkRFQ0lNQUwoNCkgQ1JFRElUUkFUSU5HLAogX2MxODo6c3RyaW5nIE9XTk9SUkVOVEZMQUcsIF9jMTk6OnN0cmluZyBFTVBMT1lFUiwKIF9jMjA6OkRFQ0lNQUwoMikgTlVNQkVSQ1JFRElUQ0FSRFMsIF9jMjE6OkRFQ0lNQUwoMTIpIE5FVFdPUlRICmZyb20gY2xvdWRfZmlsZXMoCiAgICAgICAgICAgICAgICAgInMzOi8vdHBjZGktZmlsZXMvdG1wL3RwY2RpL3NmPSR7dHBjZGlfc2NhbGV9L0JhdGNoJHtmaWxlX2NvdW50ZXJ9L1Byb3NwZWN0IiwKICAgICAgICAgICAgICAgICAiY3N2IiwKICAgICAgICAgICAgICAgICBtYXAoImluZmVyU2NoZW1hIiwgIkZhbHNlIiwgCiAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAiaGVhZGVyIiwgIkZhbHNlIiwKICAgICAgICAgICAgICAgICAgICAgImRlbGltaXRlciIsICIsIikKICAgICAgICAgICAgICAgICk=",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_STATUSTYPE_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_statustype_stg\n(ST_ID string NOT NULL COMMENT 'STATUS CODE',\n ST_NAME string NOT NULL COMMENT 'STATUS DESCRIPTION')\nusing delta \nas select\n _c0::string ST_ID, _c1::string ST_NAME\nfrom cloud_files(\n                 \"s3://tpcdi-files/tmp/tpcdi/sf=${tpcdi_scale}/Batch1/StatusType.txt\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_statustype_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX3N0YXR1c3R5cGVfc3RnCihTVF9JRCBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnU1RBVFVTIENPREUnLAogU1RfTkFNRSBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnU1RBVFVTIERFU0NSSVBUSU9OJykKdXNpbmcgZGVsdGEgCmFzIHNlbGVjdAogX2MwOjpzdHJpbmcgU1RfSUQsIF9jMTo6c3RyaW5nIFNUX05BTUUKZnJvbSBjbG91ZF9maWxlcygKICAgICAgICAgICAgICAgICAiczM6Ly90cGNkaS1maWxlcy90bXAvdHBjZGkvc2Y9JHt0cGNkaV9zY2FsZX0vQmF0Y2gxL1N0YXR1c1R5cGUudHh0IiwKICAgICAgICAgICAgICAgICAiY3N2IiwKICAgICAgICAgICAgICAgICBtYXAoImluZmVyU2NoZW1hIiwgIkZhbHNlIiwgCiAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAiaGVhZGVyIiwgIkZhbHNlIiwKICAgICAgICAgICAgICAgICAgICAgImRlbGltaXRlciIsICJ8IikKICAgICAgICAgICAgICAgICk=",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_TAXRATE_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_taxrate_stg\n(TX_ID string NOT NULL COMMENT 'TAX RATE CODE',\n TX_NAME string NOT NULL COMMENT 'TAX RATE DESCRIPTION', TX_RATE DECIMAL ( 6 ,\n 5 ) NOT NULL COMMENT 'TAX RATE')\nusing delta \nas select\n _c0::string TX_ID, _c1::string TX_NAME, _c2::DECIMAL(6, 5) TX_RATE\nfrom cloud_files(\n                 \"s3://tpcdi-files/tmp/tpcdi/sf=${tpcdi_scale}/Batch1/TaxRate.txt\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_taxrate_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX3RheHJhdGVfc3RnCihUWF9JRCBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnVEFYIFJBVEUgQ09ERScsCiBUWF9OQU1FIHN0cmluZyBOT1QgTlVMTCBDT01NRU5UICdUQVggUkFURSBERVNDUklQVElPTicsIFRYX1JBVEUgREVDSU1BTCAoIDYgLAogNSApIE5PVCBOVUxMIENPTU1FTlQgJ1RBWCBSQVRFJykKdXNpbmcgZGVsdGEgCmFzIHNlbGVjdAogX2MwOjpzdHJpbmcgVFhfSUQsIF9jMTo6c3RyaW5nIFRYX05BTUUsIF9jMjo6REVDSU1BTCg2LCA1KSBUWF9SQVRFCmZyb20gY2xvdWRfZmlsZXMoCiAgICAgICAgICAgICAgICAgInMzOi8vdHBjZGktZmlsZXMvdG1wL3RwY2RpL3NmPSR7dHBjZGlfc2NhbGV9L0JhdGNoMS9UYXhSYXRlLnR4dCIsCiAgICAgICAgICAgICAgICAgImNzdiIsCiAgICAgICAgICAgICAgICAgbWFwKCJpbmZlclNjaGVtYSIsICJGYWxzZSIsIAogICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgImhlYWRlciIsICJGYWxzZSIsCiAgICAgICAgICAgICAgICAgICAgICJkZWxpbWl0ZXIiLCAifCIpCiAgICAgICAgICAgICAgICAp",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_TIME_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_time_stg\n(SK_TIMEID INT NOT NULL COMMENT 'SURROGATE KEY FOR THE TIME',\n TIMEVALUE string NOT NULL COMMENT 'THE TIME AS TEXT, E.G. \u201c01:23:45\u201d',\n HOURID DECIMAL ( 2 ) NOT NULL COMMENT 'HOUR NUMBER AS A NUMBER, E.G. 01',\n HOURDESC string NOT NULL COMMENT 'HOUR NUMBER AS TEXT, E.G. \u201c01\u201d',\n MINUTEID DECIMAL ( 2 ) NOT NULL COMMENT 'MINUTE AS A NUMBER, E.G. 23',\n MINUTEDESC string NOT NULL COMMENT 'MINUTE AS TEXT, E.G. \u201c01:23\u201d',\n SECONDID DECIMAL ( 2 ) NOT NULL COMMENT 'SECOND AS A NUMBER, E.G. 45',\n SECONDDESC string NOT NULL COMMENT 'SECOND AS TEXT, E.G. \u201c01:23:45\u201d',\n MARKETHOURSFLAG BOOLEAN COMMENT 'INDICATES A TIME DURING MARKET HOURS',\n OFFICEHOURSFLAG BOOLEAN COMMENT 'INDICATES A TIME DURING OFFICE HOURS')\nusing delta \nas select\n _c0::INT SK_TIMEID, _c1::string TIMEVALUE, _c2::DECIMAL(2) HOURID,\n _c3::string HOURDESC, _c4::DECIMAL(2) MINUTEID, _c5::string MINUTEDESC,\n _c6::DECIMAL(2) SECONDID, _c7::string SECONDDESC,\n _c8::BOOLEAN MARKETHOURSFLAG, _c9::BOOLEAN OFFICEHOURSFLAG\nfrom cloud_files(\n                 \"s3://tpcdi-files/tmp/tpcdi/sf=${tpcdi_scale}/Batch1/Time.txt\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_time_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX3RpbWVfc3RnCihTS19USU1FSUQgSU5UIE5PVCBOVUxMIENPTU1FTlQgJ1NVUlJPR0FURSBLRVkgRk9SIFRIRSBUSU1FJywKIFRJTUVWQUxVRSBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnVEhFIFRJTUUgQVMgVEVYVCwgRS5HLiDigJwwMToyMzo0NeKAnScsCiBIT1VSSUQgREVDSU1BTCAoIDIgKSBOT1QgTlVMTCBDT01NRU5UICdIT1VSIE5VTUJFUiBBUyBBIE5VTUJFUiwgRS5HLiAwMScsCiBIT1VSREVTQyBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnSE9VUiBOVU1CRVIgQVMgVEVYVCwgRS5HLiDigJwwMeKAnScsCiBNSU5VVEVJRCBERUNJTUFMICggMiApIE5PVCBOVUxMIENPTU1FTlQgJ01JTlVURSBBUyBBIE5VTUJFUiwgRS5HLiAyMycsCiBNSU5VVEVERVNDIHN0cmluZyBOT1QgTlVMTCBDT01NRU5UICdNSU5VVEUgQVMgVEVYVCwgRS5HLiDigJwwMToyM+KAnScsCiBTRUNPTkRJRCBERUNJTUFMICggMiApIE5PVCBOVUxMIENPTU1FTlQgJ1NFQ09ORCBBUyBBIE5VTUJFUiwgRS5HLiA0NScsCiBTRUNPTkRERVNDIHN0cmluZyBOT1QgTlVMTCBDT01NRU5UICdTRUNPTkQgQVMgVEVYVCwgRS5HLiDigJwwMToyMzo0NeKAnScsCiBNQVJLRVRIT1VSU0ZMQUcgQk9PTEVBTiBDT01NRU5UICdJTkRJQ0FURVMgQSBUSU1FIERVUklORyBNQVJLRVQgSE9VUlMnLAogT0ZGSUNFSE9VUlNGTEFHIEJPT0xFQU4gQ09NTUVOVCAnSU5ESUNBVEVTIEEgVElNRSBEVVJJTkcgT0ZGSUNFIEhPVVJTJykKdXNpbmcgZGVsdGEgCmFzIHNlbGVjdAogX2MwOjpJTlQgU0tfVElNRUlELCBfYzE6OnN0cmluZyBUSU1FVkFMVUUsIF9jMjo6REVDSU1BTCgyKSBIT1VSSUQsCiBfYzM6OnN0cmluZyBIT1VSREVTQywgX2M0OjpERUNJTUFMKDIpIE1JTlVURUlELCBfYzU6OnN0cmluZyBNSU5VVEVERVNDLAogX2M2OjpERUNJTUFMKDIpIFNFQ09ORElELCBfYzc6OnN0cmluZyBTRUNPTkRERVNDLAogX2M4OjpCT09MRUFOIE1BUktFVEhPVVJTRkxBRywgX2M5OjpCT09MRUFOIE9GRklDRUhPVVJTRkxBRwpmcm9tIGNsb3VkX2ZpbGVzKAogICAgICAgICAgICAgICAgICJzMzovL3RwY2RpLWZpbGVzL3RtcC90cGNkaS9zZj0ke3RwY2RpX3NjYWxlfS9CYXRjaDEvVGltZS50eHQiLAogICAgICAgICAgICAgICAgICJjc3YiLAogICAgICAgICAgICAgICAgIG1hcCgiaW5mZXJTY2hlbWEiLCAiRmFsc2UiLCAKICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICJoZWFkZXIiLCAiRmFsc2UiLAogICAgICAgICAgICAgICAgICAgICAiZGVsaW1pdGVyIiwgInwiKQogICAgICAgICAgICAgICAgKQ==",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_TRADETYPE_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_tradetype_stg\n(TT_ID string NOT NULL COMMENT 'TRADE TYPE CODE',\n TT_NAME string NOT NULL COMMENT 'TRADE TYPE DESCRIPTION',\n TT_IS_SELL INT NOT NULL COMMENT 'FLAG INDICATING A SALE',\n TT_IS_MRKT INT NOT NULL COMMENT 'FLAG INDICATING A MARKET ORDER')\nusing delta \nas select\n _c0::string TT_ID, _c1::string TT_NAME, _c2::INT TT_IS_SELL,\n _c3::INT TT_IS_MRKT\nfrom cloud_files(\n                 \"s3://tpcdi-files/tmp/tpcdi/sf=${tpcdi_scale}/Batch1/TradeType.txt\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_tradetype_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX3RyYWRldHlwZV9zdGcKKFRUX0lEIHN0cmluZyBOT1QgTlVMTCBDT01NRU5UICdUUkFERSBUWVBFIENPREUnLAogVFRfTkFNRSBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnVFJBREUgVFlQRSBERVNDUklQVElPTicsCiBUVF9JU19TRUxMIElOVCBOT1QgTlVMTCBDT01NRU5UICdGTEFHIElORElDQVRJTkcgQSBTQUxFJywKIFRUX0lTX01SS1QgSU5UIE5PVCBOVUxMIENPTU1FTlQgJ0ZMQUcgSU5ESUNBVElORyBBIE1BUktFVCBPUkRFUicpCnVzaW5nIGRlbHRhIAphcyBzZWxlY3QKIF9jMDo6c3RyaW5nIFRUX0lELCBfYzE6OnN0cmluZyBUVF9OQU1FLCBfYzI6OklOVCBUVF9JU19TRUxMLAogX2MzOjpJTlQgVFRfSVNfTVJLVApmcm9tIGNsb3VkX2ZpbGVzKAogICAgICAgICAgICAgICAgICJzMzovL3RwY2RpLWZpbGVzL3RtcC90cGNkaS9zZj0ke3RwY2RpX3NjYWxlfS9CYXRjaDEvVHJhZGVUeXBlLnR4dCIsCiAgICAgICAgICAgICAgICAgImNzdiIsCiAgICAgICAgICAgICAgICAgbWFwKCJpbmZlclNjaGVtYSIsICJGYWxzZSIsIAogICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgImhlYWRlciIsICJGYWxzZSIsCiAgICAgICAgICAgICAgICAgICAgICJkZWxpbWl0ZXIiLCAifCIpCiAgICAgICAgICAgICAgICAp",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_TRADE_H_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_trade_stg\n(CDC_FLAG string COMMENT 'I, U DENOTES INSERT, UPDATE',\n CDC_DSN DECIMAL ( 12 ) COMMENT 'DATABASE SEQUENCE NUMBER',\n T_ID DECIMAL ( 15 ) NOT NULL COMMENT 'TRADE IDENTIFIER.',\n T_DTS TIMESTAMP NOT NULL COMMENT 'DATE AND TIME OF TRADE.',\n T_ST_ID string NOT NULL COMMENT 'STATUS TYPE IDENTIFIER',\n T_TT_ID string NOT NULL COMMENT 'TRADE TYPE IDENTIFIER',\n T_IS_CASH INT COMMENT 'IS THIS TRADE A CASH (1) OR MARGIN (0) TRADE?',\n T_S_SYMB string NOT NULL COMMENT 'SECURITY SYMBOL OF THE SECURITY',\n T_QTY DECIMAL ( 6 ) COMMENT 'QUANTITY OF SECURITIES TRADED.',\n T_BID_PRICE DECIMAL ( 8 , 2 ) COMMENT 'THE REQUESTED UNIT PRICE.',\n T_CA_ID DECIMAL ( 11 ) NOT NULL COMMENT 'CUSTOMER ACCOUNT IDENTIFIER.',\n T_EXEC_NAME string NOT NULL COMMENT 'NAME OF THE PERSON EXECUTING THE TRADE.', T_TRADE_PRICE DECIMAL ( 8 , 2 ) COMMENT 'UNIT PRICE AT WHICH THE SECURITY WAS TRADED.', T_CHRG DECIMAL ( 10 , 2 ) COMMENT 'FEE CHARGED FOR PLACING THIS TRADE REQUEST.', T_COMM DECIMAL ( 10 , 2 ) COMMENT 'COMMISSION EARNED ON THIS TRADE', T_TAX DECIMAL ( 10 , 2 ) COMMENT 'AMOUNT OF TAX DUE ON THIS TRADE')\nusing delta \nas select\n _c0::string T_ID, _c1::DECIMAL(12) T_DTS, _c2::DECIMAL(15) T_ST_ID,\n _c3::TIMESTAMP T_TT_ID, _c4::string T_IS_CASH, _c5::string T_S_SYMB,\n _c6::INT T_QTY, _c7::string T_BID_PRICE, _c8::DECIMAL(6) T_CA_ID,\n _c9::DECIMAL(8, 2) T_EXEC_NAME, _c10::DECIMAL(11) T_TRADE_PRICE,\n _c11::string T_CHRG, _c12::DECIMAL(8, 2) T_COMM, _c13::DECIMAL(10, 2) T_TAX\nfrom cloud_files(\n                 \"s3://tpcdi-files\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_trade_h_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX3RyYWRlX3N0ZwooQ0RDX0ZMQUcgc3RyaW5nIENPTU1FTlQgJ0ksIFUgREVOT1RFUyBJTlNFUlQsIFVQREFURScsCiBDRENfRFNOIERFQ0lNQUwgKCAxMiApIENPTU1FTlQgJ0RBVEFCQVNFIFNFUVVFTkNFIE5VTUJFUicsCiBUX0lEIERFQ0lNQUwgKCAxNSApIE5PVCBOVUxMIENPTU1FTlQgJ1RSQURFIElERU5USUZJRVIuJywKIFRfRFRTIFRJTUVTVEFNUCBOT1QgTlVMTCBDT01NRU5UICdEQVRFIEFORCBUSU1FIE9GIFRSQURFLicsCiBUX1NUX0lEIHN0cmluZyBOT1QgTlVMTCBDT01NRU5UICdTVEFUVVMgVFlQRSBJREVOVElGSUVSJywKIFRfVFRfSUQgc3RyaW5nIE5PVCBOVUxMIENPTU1FTlQgJ1RSQURFIFRZUEUgSURFTlRJRklFUicsCiBUX0lTX0NBU0ggSU5UIENPTU1FTlQgJ0lTIFRISVMgVFJBREUgQSBDQVNIICgxKSBPUiBNQVJHSU4gKDApIFRSQURFPycsCiBUX1NfU1lNQiBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnU0VDVVJJVFkgU1lNQk9MIE9GIFRIRSBTRUNVUklUWScsCiBUX1FUWSBERUNJTUFMICggNiApIENPTU1FTlQgJ1FVQU5USVRZIE9GIFNFQ1VSSVRJRVMgVFJBREVELicsCiBUX0JJRF9QUklDRSBERUNJTUFMICggOCAsIDIgKSBDT01NRU5UICdUSEUgUkVRVUVTVEVEIFVOSVQgUFJJQ0UuJywKIFRfQ0FfSUQgREVDSU1BTCAoIDExICkgTk9UIE5VTEwgQ09NTUVOVCAnQ1VTVE9NRVIgQUNDT1VOVCBJREVOVElGSUVSLicsCiBUX0VYRUNfTkFNRSBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnTkFNRSBPRiBUSEUgUEVSU09OIEVYRUNVVElORyBUSEUgVFJBREUuJywgVF9UUkFERV9QUklDRSBERUNJTUFMICggOCAsIDIgKSBDT01NRU5UICdVTklUIFBSSUNFIEFUIFdISUNIIFRIRSBTRUNVUklUWSBXQVMgVFJBREVELicsIFRfQ0hSRyBERUNJTUFMICggMTAgLCAyICkgQ09NTUVOVCAnRkVFIENIQVJHRUQgRk9SIFBMQUNJTkcgVEhJUyBUUkFERSBSRVFVRVNULicsIFRfQ09NTSBERUNJTUFMICggMTAgLCAyICkgQ09NTUVOVCAnQ09NTUlTU0lPTiBFQVJORUQgT04gVEhJUyBUUkFERScsIFRfVEFYIERFQ0lNQUwgKCAxMCAsIDIgKSBDT01NRU5UICdBTU9VTlQgT0YgVEFYIERVRSBPTiBUSElTIFRSQURFJykKdXNpbmcgZGVsdGEgCmFzIHNlbGVjdAogX2MwOjpzdHJpbmcgVF9JRCwgX2MxOjpERUNJTUFMKDEyKSBUX0RUUywgX2MyOjpERUNJTUFMKDE1KSBUX1NUX0lELAogX2MzOjpUSU1FU1RBTVAgVF9UVF9JRCwgX2M0OjpzdHJpbmcgVF9JU19DQVNILCBfYzU6OnN0cmluZyBUX1NfU1lNQiwKIF9jNjo6SU5UIFRfUVRZLCBfYzc6OnN0cmluZyBUX0JJRF9QUklDRSwgX2M4OjpERUNJTUFMKDYpIFRfQ0FfSUQsCiBfYzk6OkRFQ0lNQUwoOCwgMikgVF9FWEVDX05BTUUsIF9jMTA6OkRFQ0lNQUwoMTEpIFRfVFJBREVfUFJJQ0UsCiBfYzExOjpzdHJpbmcgVF9DSFJHLCBfYzEyOjpERUNJTUFMKDgsIDIpIFRfQ09NTSwgX2MxMzo6REVDSU1BTCgxMCwgMikgVF9UQVgKZnJvbSBjbG91ZF9maWxlcygKICAgICAgICAgICAgICAgICAiczM6Ly90cGNkaS1maWxlcyIsCiAgICAgICAgICAgICAgICAgImNzdiIsCiAgICAgICAgICAgICAgICAgbWFwKCJpbmZlclNjaGVtYSIsICJGYWxzZSIsIAogICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgImhlYWRlciIsICJGYWxzZSIsCiAgICAgICAgICAgICAgICAgICAgICJkZWxpbWl0ZXIiLCAifCIpCiAgICAgICAgICAgICAgICAp",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_TRADE_I_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_trade_stg\n(CDC_FLAG string COMMENT 'I, U DENOTES INSERT, UPDATE',\n CDC_DSN DECIMAL ( 12 ) COMMENT 'DATABASE SEQUENCE NUMBER',\n T_ID DECIMAL ( 15 ) NOT NULL COMMENT 'TRADE IDENTIFIER.',\n T_DTS TIMESTAMP NOT NULL COMMENT 'DATE AND TIME OF TRADE.',\n T_ST_ID string NOT NULL COMMENT 'STATUS TYPE IDENTIFIER',\n T_TT_ID string NOT NULL COMMENT 'TRADE TYPE IDENTIFIER',\n T_IS_CASH INT COMMENT 'IS THIS TRADE A CASH (1) OR MARGIN (0) TRADE?',\n T_S_SYMB string NOT NULL COMMENT 'SECURITY SYMBOL OF THE SECURITY',\n T_QTY DECIMAL ( 6 ) COMMENT 'QUANTITY OF SECURITIES TRADED.',\n T_BID_PRICE DECIMAL ( 8 , 2 ) COMMENT 'THE REQUESTED UNIT PRICE.',\n T_CA_ID DECIMAL ( 11 ) NOT NULL COMMENT 'CUSTOMER ACCOUNT IDENTIFIER.',\n T_EXEC_NAME string NOT NULL COMMENT 'NAME OF THE PERSON EXECUTING THE TRADE.', T_TRADE_PRICE DECIMAL ( 8 , 2 ) COMMENT 'UNIT PRICE AT WHICH THE SECURITY WAS TRADED.', T_CHRG DECIMAL ( 10 , 2 ) COMMENT 'FEE CHARGED FOR PLACING THIS TRADE REQUEST.', T_COMM DECIMAL ( 10 , 2 ) COMMENT 'COMMISSION EARNED ON THIS TRADE', T_TAX DECIMAL ( 10 , 2 ) COMMENT 'AMOUNT OF TAX DUE ON THIS TRADE')\nusing delta \nas select\n _c0::string CDC_FLAG, _c1::DECIMAL(12) CDC_DSN, _c2::DECIMAL(15) T_ID,\n _c3::TIMESTAMP T_DTS, _c4::string T_ST_ID, _c5::string T_TT_ID,\n _c6::INT T_IS_CASH, _c7::string T_S_SYMB, _c8::DECIMAL(6) T_QTY,\n _c9::DECIMAL(8, 2) T_BID_PRICE, _c10::DECIMAL(11) T_CA_ID,\n _c11::string T_EXEC_NAME, _c12::DECIMAL(8, 2) T_TRADE_PRICE,\n _c13::DECIMAL(10, 2) T_CHRG, _c14::DECIMAL(10, 2) T_COMM, _c15::DECIMAL(10,\n 2) T_TAX\nfrom cloud_files(\n                 \"s3://tpcdi-files/tmp/tpcdi/sf=${tpcdi_scale}/Batch${batch_counter}/Trade\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_trade_i_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX3RyYWRlX3N0ZwooQ0RDX0ZMQUcgc3RyaW5nIENPTU1FTlQgJ0ksIFUgREVOT1RFUyBJTlNFUlQsIFVQREFURScsCiBDRENfRFNOIERFQ0lNQUwgKCAxMiApIENPTU1FTlQgJ0RBVEFCQVNFIFNFUVVFTkNFIE5VTUJFUicsCiBUX0lEIERFQ0lNQUwgKCAxNSApIE5PVCBOVUxMIENPTU1FTlQgJ1RSQURFIElERU5USUZJRVIuJywKIFRfRFRTIFRJTUVTVEFNUCBOT1QgTlVMTCBDT01NRU5UICdEQVRFIEFORCBUSU1FIE9GIFRSQURFLicsCiBUX1NUX0lEIHN0cmluZyBOT1QgTlVMTCBDT01NRU5UICdTVEFUVVMgVFlQRSBJREVOVElGSUVSJywKIFRfVFRfSUQgc3RyaW5nIE5PVCBOVUxMIENPTU1FTlQgJ1RSQURFIFRZUEUgSURFTlRJRklFUicsCiBUX0lTX0NBU0ggSU5UIENPTU1FTlQgJ0lTIFRISVMgVFJBREUgQSBDQVNIICgxKSBPUiBNQVJHSU4gKDApIFRSQURFPycsCiBUX1NfU1lNQiBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnU0VDVVJJVFkgU1lNQk9MIE9GIFRIRSBTRUNVUklUWScsCiBUX1FUWSBERUNJTUFMICggNiApIENPTU1FTlQgJ1FVQU5USVRZIE9GIFNFQ1VSSVRJRVMgVFJBREVELicsCiBUX0JJRF9QUklDRSBERUNJTUFMICggOCAsIDIgKSBDT01NRU5UICdUSEUgUkVRVUVTVEVEIFVOSVQgUFJJQ0UuJywKIFRfQ0FfSUQgREVDSU1BTCAoIDExICkgTk9UIE5VTEwgQ09NTUVOVCAnQ1VTVE9NRVIgQUNDT1VOVCBJREVOVElGSUVSLicsCiBUX0VYRUNfTkFNRSBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnTkFNRSBPRiBUSEUgUEVSU09OIEVYRUNVVElORyBUSEUgVFJBREUuJywgVF9UUkFERV9QUklDRSBERUNJTUFMICggOCAsIDIgKSBDT01NRU5UICdVTklUIFBSSUNFIEFUIFdISUNIIFRIRSBTRUNVUklUWSBXQVMgVFJBREVELicsIFRfQ0hSRyBERUNJTUFMICggMTAgLCAyICkgQ09NTUVOVCAnRkVFIENIQVJHRUQgRk9SIFBMQUNJTkcgVEhJUyBUUkFERSBSRVFVRVNULicsIFRfQ09NTSBERUNJTUFMICggMTAgLCAyICkgQ09NTUVOVCAnQ09NTUlTU0lPTiBFQVJORUQgT04gVEhJUyBUUkFERScsIFRfVEFYIERFQ0lNQUwgKCAxMCAsIDIgKSBDT01NRU5UICdBTU9VTlQgT0YgVEFYIERVRSBPTiBUSElTIFRSQURFJykKdXNpbmcgZGVsdGEgCmFzIHNlbGVjdAogX2MwOjpzdHJpbmcgQ0RDX0ZMQUcsIF9jMTo6REVDSU1BTCgxMikgQ0RDX0RTTiwgX2MyOjpERUNJTUFMKDE1KSBUX0lELAogX2MzOjpUSU1FU1RBTVAgVF9EVFMsIF9jNDo6c3RyaW5nIFRfU1RfSUQsIF9jNTo6c3RyaW5nIFRfVFRfSUQsCiBfYzY6OklOVCBUX0lTX0NBU0gsIF9jNzo6c3RyaW5nIFRfU19TWU1CLCBfYzg6OkRFQ0lNQUwoNikgVF9RVFksCiBfYzk6OkRFQ0lNQUwoOCwgMikgVF9CSURfUFJJQ0UsIF9jMTA6OkRFQ0lNQUwoMTEpIFRfQ0FfSUQsCiBfYzExOjpzdHJpbmcgVF9FWEVDX05BTUUsIF9jMTI6OkRFQ0lNQUwoOCwgMikgVF9UUkFERV9QUklDRSwKIF9jMTM6OkRFQ0lNQUwoMTAsIDIpIFRfQ0hSRywgX2MxNDo6REVDSU1BTCgxMCwgMikgVF9DT01NLCBfYzE1OjpERUNJTUFMKDEwLAogMikgVF9UQVgKZnJvbSBjbG91ZF9maWxlcygKICAgICAgICAgICAgICAgICAiczM6Ly90cGNkaS1maWxlcy90bXAvdHBjZGkvc2Y9JHt0cGNkaV9zY2FsZX0vQmF0Y2gke2JhdGNoX2NvdW50ZXJ9L1RyYWRlIiwKICAgICAgICAgICAgICAgICAiY3N2IiwKICAgICAgICAgICAgICAgICBtYXAoImluZmVyU2NoZW1hIiwgIkZhbHNlIiwgCiAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAiaGVhZGVyIiwgIkZhbHNlIiwKICAgICAgICAgICAgICAgICAgICAgImRlbGltaXRlciIsICJ8IikKICAgICAgICAgICAgICAgICk=",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_TRADE_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_trade_stg\n(CDC_FLAG string COMMENT 'I, U DENOTES INSERT, UPDATE',\n CDC_DSN DECIMAL ( 12 ) COMMENT 'DATABASE SEQUENCE NUMBER',\n T_ID DECIMAL ( 15 ) NOT NULL COMMENT 'TRADE IDENTIFIER.',\n T_DTS TIMESTAMP NOT NULL COMMENT 'DATE AND TIME OF TRADE.',\n T_ST_ID string NOT NULL COMMENT 'STATUS TYPE IDENTIFIER',\n T_TT_ID string NOT NULL COMMENT 'TRADE TYPE IDENTIFIER',\n T_IS_CASH INT COMMENT 'IS THIS TRADE A CASH (1) OR MARGIN (0) TRADE?',\n T_S_SYMB string NOT NULL COMMENT 'SECURITY SYMBOL OF THE SECURITY',\n T_QTY DECIMAL ( 6 ) COMMENT 'QUANTITY OF SECURITIES TRADED.',\n T_BID_PRICE DECIMAL ( 8 , 2 ) COMMENT 'THE REQUESTED UNIT PRICE.',\n T_CA_ID DECIMAL ( 11 ) NOT NULL COMMENT 'CUSTOMER ACCOUNT IDENTIFIER.',\n T_EXEC_NAME string NOT NULL COMMENT 'NAME OF THE PERSON EXECUTING THE TRADE.', T_TRADE_PRICE DECIMAL ( 8 , 2 ) COMMENT 'UNIT PRICE AT WHICH THE SECURITY WAS TRADED.', T_CHRG DECIMAL ( 10 , 2 ) COMMENT 'FEE CHARGED FOR PLACING THIS TRADE REQUEST.', T_COMM DECIMAL ( 10 , 2 ) COMMENT 'COMMISSION EARNED ON THIS TRADE', T_TAX DECIMAL ( 10 , 2 ) COMMENT 'AMOUNT OF TAX DUE ON THIS TRADE')\nusing delta \nas select\n _c0::string CDC_FLAG, _c1::DECIMAL(12) CDC_DSN, _c2::DECIMAL(15) T_ID,\n _c3::TIMESTAMP T_DTS, _c4::string T_ST_ID, _c5::string T_TT_ID,\n _c6::INT T_IS_CASH, _c7::string T_S_SYMB, _c8::DECIMAL(6) T_QTY,\n _c9::DECIMAL(8, 2) T_BID_PRICE, _c10::DECIMAL(11) T_CA_ID,\n _c11::string T_EXEC_NAME, _c12::DECIMAL(8, 2) T_TRADE_PRICE,\n _c13::DECIMAL(10, 2) T_CHRG, _c14::DECIMAL(10, 2) T_COMM, _c15::DECIMAL(10,\n 2) T_TAX\nfrom cloud_files(\n                 \"s3://tpcdi-files/load/trade/\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_trade_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX3RyYWRlX3N0ZwooQ0RDX0ZMQUcgc3RyaW5nIENPTU1FTlQgJ0ksIFUgREVOT1RFUyBJTlNFUlQsIFVQREFURScsCiBDRENfRFNOIERFQ0lNQUwgKCAxMiApIENPTU1FTlQgJ0RBVEFCQVNFIFNFUVVFTkNFIE5VTUJFUicsCiBUX0lEIERFQ0lNQUwgKCAxNSApIE5PVCBOVUxMIENPTU1FTlQgJ1RSQURFIElERU5USUZJRVIuJywKIFRfRFRTIFRJTUVTVEFNUCBOT1QgTlVMTCBDT01NRU5UICdEQVRFIEFORCBUSU1FIE9GIFRSQURFLicsCiBUX1NUX0lEIHN0cmluZyBOT1QgTlVMTCBDT01NRU5UICdTVEFUVVMgVFlQRSBJREVOVElGSUVSJywKIFRfVFRfSUQgc3RyaW5nIE5PVCBOVUxMIENPTU1FTlQgJ1RSQURFIFRZUEUgSURFTlRJRklFUicsCiBUX0lTX0NBU0ggSU5UIENPTU1FTlQgJ0lTIFRISVMgVFJBREUgQSBDQVNIICgxKSBPUiBNQVJHSU4gKDApIFRSQURFPycsCiBUX1NfU1lNQiBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnU0VDVVJJVFkgU1lNQk9MIE9GIFRIRSBTRUNVUklUWScsCiBUX1FUWSBERUNJTUFMICggNiApIENPTU1FTlQgJ1FVQU5USVRZIE9GIFNFQ1VSSVRJRVMgVFJBREVELicsCiBUX0JJRF9QUklDRSBERUNJTUFMICggOCAsIDIgKSBDT01NRU5UICdUSEUgUkVRVUVTVEVEIFVOSVQgUFJJQ0UuJywKIFRfQ0FfSUQgREVDSU1BTCAoIDExICkgTk9UIE5VTEwgQ09NTUVOVCAnQ1VTVE9NRVIgQUNDT1VOVCBJREVOVElGSUVSLicsCiBUX0VYRUNfTkFNRSBzdHJpbmcgTk9UIE5VTEwgQ09NTUVOVCAnTkFNRSBPRiBUSEUgUEVSU09OIEVYRUNVVElORyBUSEUgVFJBREUuJywgVF9UUkFERV9QUklDRSBERUNJTUFMICggOCAsIDIgKSBDT01NRU5UICdVTklUIFBSSUNFIEFUIFdISUNIIFRIRSBTRUNVUklUWSBXQVMgVFJBREVELicsIFRfQ0hSRyBERUNJTUFMICggMTAgLCAyICkgQ09NTUVOVCAnRkVFIENIQVJHRUQgRk9SIFBMQUNJTkcgVEhJUyBUUkFERSBSRVFVRVNULicsIFRfQ09NTSBERUNJTUFMICggMTAgLCAyICkgQ09NTUVOVCAnQ09NTUlTU0lPTiBFQVJORUQgT04gVEhJUyBUUkFERScsIFRfVEFYIERFQ0lNQUwgKCAxMCAsIDIgKSBDT01NRU5UICdBTU9VTlQgT0YgVEFYIERVRSBPTiBUSElTIFRSQURFJykKdXNpbmcgZGVsdGEgCmFzIHNlbGVjdAogX2MwOjpzdHJpbmcgQ0RDX0ZMQUcsIF9jMTo6REVDSU1BTCgxMikgQ0RDX0RTTiwgX2MyOjpERUNJTUFMKDE1KSBUX0lELAogX2MzOjpUSU1FU1RBTVAgVF9EVFMsIF9jNDo6c3RyaW5nIFRfU1RfSUQsIF9jNTo6c3RyaW5nIFRfVFRfSUQsCiBfYzY6OklOVCBUX0lTX0NBU0gsIF9jNzo6c3RyaW5nIFRfU19TWU1CLCBfYzg6OkRFQ0lNQUwoNikgVF9RVFksCiBfYzk6OkRFQ0lNQUwoOCwgMikgVF9CSURfUFJJQ0UsIF9jMTA6OkRFQ0lNQUwoMTEpIFRfQ0FfSUQsCiBfYzExOjpzdHJpbmcgVF9FWEVDX05BTUUsIF9jMTI6OkRFQ0lNQUwoOCwgMikgVF9UUkFERV9QUklDRSwKIF9jMTM6OkRFQ0lNQUwoMTAsIDIpIFRfQ0hSRywgX2MxNDo6REVDSU1BTCgxMCwgMikgVF9DT01NLCBfYzE1OjpERUNJTUFMKDEwLAogMikgVF9UQVgKZnJvbSBjbG91ZF9maWxlcygKICAgICAgICAgICAgICAgICAiczM6Ly90cGNkaS1maWxlcy9sb2FkL3RyYWRlLyIsCiAgICAgICAgICAgICAgICAgImNzdiIsCiAgICAgICAgICAgICAgICAgbWFwKCJpbmZlclNjaGVtYSIsICJGYWxzZSIsIAogICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgImhlYWRlciIsICJGYWxzZSIsCiAgICAgICAgICAgICAgICAgICAgICJkZWxpbWl0ZXIiLCAifCIpCiAgICAgICAgICAgICAgICAp",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_WATCH_HISTORY_H_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_watch_history_stg\n(CDC_FLAG string COMMENT 'I, U DENOTES INSERT, UPDATE',\n CDC_DSN DECIMAL ( 12 ) COMMENT 'DATABASE SEQUENCE NUMBER',\n W_C_ID DECIMAL ( 11 ) NOT NULL COMMENT 'CUSTOMER IDENTIFIER',\n W_S_SYMB string NOT NULL COMMENT 'SYMBOL OF THE SECURITY TO WATCH',\n W_DTS TIMESTAMP NOT NULL COMMENT 'DATE AND TIME STAMP FOR THE ACTION',\n W_ACTION string COMMENT 'WHETHER ACTIVATING OR CANCELING THE WATCH')\nusing delta \nas select\n _c0::string W_C_ID, _c1::DECIMAL(12) W_S_SYMB, _c2::DECIMAL(11) W_DTS,\n _c3::string W_ACTION\nfrom cloud_files(\n                 \"s3://tpcdi-files/tmp/tpcdi/sf=${tpcdi_scale}/Batch1/WatchHistory\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_watch_history_h_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX3dhdGNoX2hpc3Rvcnlfc3RnCihDRENfRkxBRyBzdHJpbmcgQ09NTUVOVCAnSSwgVSBERU5PVEVTIElOU0VSVCwgVVBEQVRFJywKIENEQ19EU04gREVDSU1BTCAoIDEyICkgQ09NTUVOVCAnREFUQUJBU0UgU0VRVUVOQ0UgTlVNQkVSJywKIFdfQ19JRCBERUNJTUFMICggMTEgKSBOT1QgTlVMTCBDT01NRU5UICdDVVNUT01FUiBJREVOVElGSUVSJywKIFdfU19TWU1CIHN0cmluZyBOT1QgTlVMTCBDT01NRU5UICdTWU1CT0wgT0YgVEhFIFNFQ1VSSVRZIFRPIFdBVENIJywKIFdfRFRTIFRJTUVTVEFNUCBOT1QgTlVMTCBDT01NRU5UICdEQVRFIEFORCBUSU1FIFNUQU1QIEZPUiBUSEUgQUNUSU9OJywKIFdfQUNUSU9OIHN0cmluZyBDT01NRU5UICdXSEVUSEVSIEFDVElWQVRJTkcgT1IgQ0FOQ0VMSU5HIFRIRSBXQVRDSCcpCnVzaW5nIGRlbHRhIAphcyBzZWxlY3QKIF9jMDo6c3RyaW5nIFdfQ19JRCwgX2MxOjpERUNJTUFMKDEyKSBXX1NfU1lNQiwgX2MyOjpERUNJTUFMKDExKSBXX0RUUywKIF9jMzo6c3RyaW5nIFdfQUNUSU9OCmZyb20gY2xvdWRfZmlsZXMoCiAgICAgICAgICAgICAgICAgInMzOi8vdHBjZGktZmlsZXMvdG1wL3RwY2RpL3NmPSR7dHBjZGlfc2NhbGV9L0JhdGNoMS9XYXRjaEhpc3RvcnkiLAogICAgICAgICAgICAgICAgICJjc3YiLAogICAgICAgICAgICAgICAgIG1hcCgiaW5mZXJTY2hlbWEiLCAiRmFsc2UiLCAKICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICJoZWFkZXIiLCAiRmFsc2UiLAogICAgICAgICAgICAgICAgICAgICAiZGVsaW1pdGVyIiwgInwiKQogICAgICAgICAgICAgICAgKQ==",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_WATCH_HISTORY_I_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_watch_history_stg\n(CDC_FLAG string COMMENT 'I, U DENOTES INSERT, UPDATE',\n CDC_DSN DECIMAL ( 12 ) COMMENT 'DATABASE SEQUENCE NUMBER',\n W_C_ID DECIMAL ( 11 ) NOT NULL COMMENT 'CUSTOMER IDENTIFIER',\n W_S_SYMB string NOT NULL COMMENT 'SYMBOL OF THE SECURITY TO WATCH',\n W_DTS TIMESTAMP NOT NULL COMMENT 'DATE AND TIME STAMP FOR THE ACTION',\n W_ACTION string COMMENT 'WHETHER ACTIVATING OR CANCELING THE WATCH')\nusing delta \nas select\n _c0::string CDC_FLAG, _c1::DECIMAL(12) CDC_DSN, _c2::DECIMAL(11) W_C_ID,\n _c3::string W_S_SYMB, _c4::TIMESTAMP W_DTS, _c5::string W_ACTION\nfrom cloud_files(\n                 \"s3://tpcdi-files/tmp/tpcdi/sf=${tpcdi_scale}/Batch${batch_counter}/WatchHistory\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_watch_history_i_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX3dhdGNoX2hpc3Rvcnlfc3RnCihDRENfRkxBRyBzdHJpbmcgQ09NTUVOVCAnSSwgVSBERU5PVEVTIElOU0VSVCwgVVBEQVRFJywKIENEQ19EU04gREVDSU1BTCAoIDEyICkgQ09NTUVOVCAnREFUQUJBU0UgU0VRVUVOQ0UgTlVNQkVSJywKIFdfQ19JRCBERUNJTUFMICggMTEgKSBOT1QgTlVMTCBDT01NRU5UICdDVVNUT01FUiBJREVOVElGSUVSJywKIFdfU19TWU1CIHN0cmluZyBOT1QgTlVMTCBDT01NRU5UICdTWU1CT0wgT0YgVEhFIFNFQ1VSSVRZIFRPIFdBVENIJywKIFdfRFRTIFRJTUVTVEFNUCBOT1QgTlVMTCBDT01NRU5UICdEQVRFIEFORCBUSU1FIFNUQU1QIEZPUiBUSEUgQUNUSU9OJywKIFdfQUNUSU9OIHN0cmluZyBDT01NRU5UICdXSEVUSEVSIEFDVElWQVRJTkcgT1IgQ0FOQ0VMSU5HIFRIRSBXQVRDSCcpCnVzaW5nIGRlbHRhIAphcyBzZWxlY3QKIF9jMDo6c3RyaW5nIENEQ19GTEFHLCBfYzE6OkRFQ0lNQUwoMTIpIENEQ19EU04sIF9jMjo6REVDSU1BTCgxMSkgV19DX0lELAogX2MzOjpzdHJpbmcgV19TX1NZTUIsIF9jNDo6VElNRVNUQU1QIFdfRFRTLCBfYzU6OnN0cmluZyBXX0FDVElPTgpmcm9tIGNsb3VkX2ZpbGVzKAogICAgICAgICAgICAgICAgICJzMzovL3RwY2RpLWZpbGVzL3RtcC90cGNkaS9zZj0ke3RwY2RpX3NjYWxlfS9CYXRjaCR7YmF0Y2hfY291bnRlcn0vV2F0Y2hIaXN0b3J5IiwKICAgICAgICAgICAgICAgICAiY3N2IiwKICAgICAgICAgICAgICAgICBtYXAoImluZmVyU2NoZW1hIiwgIkZhbHNlIiwgCiAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAiaGVhZGVyIiwgIkZhbHNlIiwKICAgICAgICAgICAgICAgICAgICAgImRlbGltaXRlciIsICJ8IikKICAgICAgICAgICAgICAgICk=",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  },
  {
    "kind": "create_or_replace_procedure",
    "item": {
      "db": "TPCDI_STG",
      "schema": "PUBLIC",
      "elem": "LOAD_WATCH_HISTORY_SP",
      "elem_type": "Procedure"
    },
    "code": "create or refresh streaming live table public_watch_history_stg\n(CDC_FLAG string COMMENT 'I, U DENOTES INSERT, UPDATE',\n CDC_DSN DECIMAL ( 12 ) COMMENT 'DATABASE SEQUENCE NUMBER',\n W_C_ID DECIMAL ( 11 ) NOT NULL COMMENT 'CUSTOMER IDENTIFIER',\n W_S_SYMB string NOT NULL COMMENT 'SYMBOL OF THE SECURITY TO WATCH',\n W_DTS TIMESTAMP NOT NULL COMMENT 'DATE AND TIME STAMP FOR THE ACTION',\n W_ACTION string COMMENT 'WHETHER ACTIVATING OR CANCELING THE WATCH')\nusing delta \nas select\n _c0::string CDC_FLAG, _c1::DECIMAL(12) CDC_DSN, _c2::DECIMAL(11) W_C_ID,\n _c3::string W_S_SYMB, _c4::TIMESTAMP W_DTS, _c5::string W_ACTION\nfrom cloud_files(\n                 \"s3://tpcdi-files/load/watch_history/\",\n                 \"csv\",\n                 map(\"inferSchema\", \"False\", \n                     \n                     \"header\", \"False\",\n                     \"delimiter\", \"|\")\n                )",
    "api": {
      "api": "/api/2.0/workspace/import",
      "json": {
        "path": "/Users/ted@novuz.com/tpc_di/tpcdi_stg_public_load_watch_history_sp",
        "content": "Y3JlYXRlIG9yIHJlZnJlc2ggc3RyZWFtaW5nIGxpdmUgdGFibGUgcHVibGljX3dhdGNoX2hpc3Rvcnlfc3RnCihDRENfRkxBRyBzdHJpbmcgQ09NTUVOVCAnSSwgVSBERU5PVEVTIElOU0VSVCwgVVBEQVRFJywKIENEQ19EU04gREVDSU1BTCAoIDEyICkgQ09NTUVOVCAnREFUQUJBU0UgU0VRVUVOQ0UgTlVNQkVSJywKIFdfQ19JRCBERUNJTUFMICggMTEgKSBOT1QgTlVMTCBDT01NRU5UICdDVVNUT01FUiBJREVOVElGSUVSJywKIFdfU19TWU1CIHN0cmluZyBOT1QgTlVMTCBDT01NRU5UICdTWU1CT0wgT0YgVEhFIFNFQ1VSSVRZIFRPIFdBVENIJywKIFdfRFRTIFRJTUVTVEFNUCBOT1QgTlVMTCBDT01NRU5UICdEQVRFIEFORCBUSU1FIFNUQU1QIEZPUiBUSEUgQUNUSU9OJywKIFdfQUNUSU9OIHN0cmluZyBDT01NRU5UICdXSEVUSEVSIEFDVElWQVRJTkcgT1IgQ0FOQ0VMSU5HIFRIRSBXQVRDSCcpCnVzaW5nIGRlbHRhIAphcyBzZWxlY3QKIF9jMDo6c3RyaW5nIENEQ19GTEFHLCBfYzE6OkRFQ0lNQUwoMTIpIENEQ19EU04sIF9jMjo6REVDSU1BTCgxMSkgV19DX0lELAogX2MzOjpzdHJpbmcgV19TX1NZTUIsIF9jNDo6VElNRVNUQU1QIFdfRFRTLCBfYzU6OnN0cmluZyBXX0FDVElPTgpmcm9tIGNsb3VkX2ZpbGVzKAogICAgICAgICAgICAgICAgICJzMzovL3RwY2RpLWZpbGVzL2xvYWQvd2F0Y2hfaGlzdG9yeS8iLAogICAgICAgICAgICAgICAgICJjc3YiLAogICAgICAgICAgICAgICAgIG1hcCgiaW5mZXJTY2hlbWEiLCAiRmFsc2UiLCAKICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICJoZWFkZXIiLCAiRmFsc2UiLAogICAgICAgICAgICAgICAgICAgICAiZGVsaW1pdGVyIiwgInwiKQogICAgICAgICAgICAgICAgKQ==",
        "language": "SQL",
        "overwrite": true,
        "format": "SOURCE"
      }
    }
  }
]
